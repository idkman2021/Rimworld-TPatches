<?xml version="1.0" encoding="utf-8"?>
<!-- available patch defs:

base patchdefs that other patchdefs use:

TP_ModBaseE - adds enabled mod setting
TP_ModBaseD - adds disabled mod setting
TP_ModLog - adds log entry
TP_MultiDisplay - adds a new mod into required mods display


___________________________________________________________
the actual patchdefs to create mod settings:


TP_ModPatch - the main patch, checks if a mod is enabled and creates a setting in the appropriate style, and adds a log entry if logging is enabled:
<li>key</li>key
<li>mod</li>
<li>tab</li> Fixes Tweaks Balancing Settings
<li>label</li>
<li>description</li>
<li>tooltip</li>
<li>default</li> ENABLED/DISABLED


TP_ModPatch2 - identical to TP_ModPatch, but checks for 2 mods
TP_ModPatch3 - checks for 3 mods
TP_ModPatch4 - checks for 4 mods
<li>key</li>key
<li>mod</li>
<li>2nd mod</li>
<li>3rd mod</li> *
<li>4th mod</li> *
<li>logic</li> or/and
<li>tab</li> Fixes Tweaks Balancing Settings
<li>label</li>
<li>description</li>
<li>tooltip</li>
<li>default</li> ENABLED/DISABLED


TP_Toggle - a simple toggle setting with no description, doesn't check for mods
<li>key</li>
<li>tab</li>
<li>label</li>
<li>tooltip</li>


TP_ModPatchGrouped - identical to TP_ModPatch but shows only when a given key is on
<li>key</li>key
<li>mod</li>
<li>tab</li> Fixes Tweaks Balancing Settings
<li>label</li>
<li>description</li>
<li>tooltip</li>
<li>default</li> ENABLED/DISABLED
<li>group</li> key of the setting that shows this


TP_Tab - creates a tab
<li>tab</li>
<li>description</li>



-->

<Defs>

    <!-- mod is active, adds the setting to the top of settings list -->
    <XmlExtensions.PatchDef Name="TP_ModBaseE" Abstract="True">
        <parameters>
            <li>key</li> <!-- key -->
            <li>mod</li> <!-- required mod -->
            <li>tab</li> <!-- tab - Fixes Tweaks Balancing Settings-->
            <li>label</li> <!-- label -->
            <li>description</li> <!-- description -->
            <li>tooltip</li> <!-- tooltip -->
            <li>default</li> <!-- ENABLED/DISABLED -->
            <li>color</li>
            <li>split1</li>
            <li>split2</li>
            <li>group</li>
            <li>enabled</li>
        </parameters>
        <apply>

            <Operation Class="XmlExtensions.PatchOperationAdd">
                <xmlDoc>{tab}</xmlDoc>
                <order>Append</order>
                <xpath>{tab}/settings/li[tag="{enabled}"]/settings</xpath>
                <value>
                    <li Class="XmlExtensions.Setting.ToggleableSettings">
                        <key>{group}</key>
                        <caseTrue>
                            <li Class="XmlExtensions.Setting.Gap">
                                <spacing>1</spacing>
                            </li>
                            <li Class="XmlExtensions.Setting.SplitColumns">
                                <gapSize>6</gapSize>
                                <drawLine>false</drawLine>
                                <splits>
                                    <li>0.5</li>
                                </splits>
                                <settings>
                                    <!-- title -->
                                    <li>
                                        <li Class="XmlExtensions.Setting.SetColor">
                                            <color>(200,200,255)</color>
                                        </li>
                                        <li Class="XmlExtensions.Setting.Text">
                                            <text>{label}</text>
                                        </li>
                                    </li>
                                    <!-- checkbox -->
                                    <li>
                                        <li Class="XmlExtensions.Setting.Checkbox">
                                            <key>{key}</key>
                                            <!-- <label>{label}</label> -->
                                            <tooltip>{tooltip}</tooltip>
                                        </li>
                                    </li>
                                </settings>
                            </li>
                            <li Class="XmlExtensions.Setting.Gap">
                                <spacing>-4</spacing>
                            </li>
                            <li Class="XmlExtensions.Setting.SplitColumns">
                                <tag>{mod}</tag>
                                <gapSize>3</gapSize>
                                <drawLine>false</drawLine>
                                <splits>
                                    <li>{split1}</li> <!-- 0.11 -->
                                    <li>{split2}</li> <!-- 0.8 -->
                                </splits>
                                <settings>
                                    <!-- mod -->
                                    <li>
                                        <li Class="XmlExtensions.Setting.SetColor">
                                            <color>{color}</color> <!-- (155,225,155) -->
                                        </li>

                                        <li Class="XmlExtensions.Setting.Text">
                                            <font>Tiny</font>
                                            <anchor>Left</anchor>
                                            <text>{mod}</text>
                                            <tag>{key}</tag>
                                        </li>
                                    </li>
                                    <!-- description -->
                                    <li>
                                        <li Class="XmlExtensions.Setting.SetColor">
                                            <color>(235,235,235)</color>
                                        </li>
                                        <li Class="XmlExtensions.Setting.Text">
                                            <!-- <font>Tiny</font> -->
                                            <text>{description}</text>
                                        </li>
                                    </li>
                                    <!-- default -->
                                    <li>
                                        <li Class="XmlExtensions.Setting.SetColor">
                                            <color>(155,155,155)</color>
                                        </li>
                                        <li Class="XmlExtensions.Setting.Text">
                                            <font>Tiny</font>
                                            <anchor>Right</anchor>
                                            <text>default: {default}</text>
                                        </li>
                                    </li>
                                </settings>
                            </li>
                            <li Class="XmlExtensions.Setting.SetColor">
                                <color>(80,80,80)</color>
                            </li>
                            <li Class="XmlExtensions.Setting.GapLine">
                                <spacing>-6</spacing>
                            </li>
                            <li Class="XmlExtensions.Setting.Gap">
                                <spacing>12</spacing>
                            </li>
                            <li Class="XmlExtensions.Setting.SetColor">
                                <color>(255,255,255)</color>
                            </li>
                        </caseTrue>
                    </li>
                </value>
            </Operation>

        </apply>
    </XmlExtensions.PatchDef>


    <!-- mod isn't active, setting is greyed out and added to the bottom of settings list -->
    <XmlExtensions.PatchDef Name="TP_ModBaseD" Abstract="True">
        <parameters>
            <li>key</li> <!-- key -->
            <li>mod</li> <!-- required mod -->
            <li>tab</li> <!-- tab - Fixes Tweaks Balancing Settings-->
            <li>label</li> <!-- label -->
            <li>description</li> <!-- description -->
            <li>tooltip</li> <!-- tooltip -->
            <li>default</li> <!-- ENABLED/DISABLED -->
            <li>color</li>
            <li>split1</li>
            <li>split2</li>
            <li>group</li>
            <li>enabled</li>
        </parameters>
        <apply>
            <Operation Class="XmlExtensions.PatchOperationAdd">
                <xmlDoc>{tab}</xmlDoc>
                <order>Append</order>
                <xpath>{tab}/settings/li[tag="{enabled}"]/settings</xpath>
                <value>
                    <li Class="XmlExtensions.Setting.ToggleableSettings">
                        <key>{group}</key>
                        <caseTrue>
                            <li Class="XmlExtensions.Setting.Gap">
                                <tag>DisabledCheck</tag>
                                <spacing>-4</spacing>
                            </li>
                            <li Class="XmlExtensions.Setting.SplitColumns">
                                <gapSize>6</gapSize>
                                <drawLine>false</drawLine>
                                <splits>
                                    <li>0.5</li>
                                </splits>
                                <settings>
                                    <!-- title -->
                                    <li>
                                        <li Class="XmlExtensions.Setting.SetColor">
                                            <color>(100,100,155)</color>
                                        </li>
                                        <li Class="XmlExtensions.Setting.Text">
                                            <font>Tiny</font>
                                            <text>{label}</text>
                                        </li>
                                    </li>
                                    <!-- checkbox -->
                                    <li>
                                        <li Class="XmlExtensions.Setting.SetColor">
                                            <color>(100,100,100)</color>
                                        </li>
                                        <li Class="XmlExtensions.Setting.Checkbox">
                                            <key>{key}</key>
                                            <!-- <label>{label}</label> -->
                                            <tooltip>{tooltip}</tooltip>
                                        </li>
                                    </li>
                                </settings>
                            </li>

                            <li Class="XmlExtensions.Setting.SplitColumns">
                                <tag>{mod}</tag>
                                <gapSize>3</gapSize>
                                <drawLine>false</drawLine>
                                <splits>
                                    <li>{split1}</li> <!-- 0.11 -->
                                    <li>{split2}</li> <!-- 0.8 -->
                                </splits>
                                <settings>
                                    <!-- mod -->
                                    <li>
                                        <li Class="XmlExtensions.Setting.SetColor">
                                            <color>{color}</color> <!-- (175,105,105) -->
                                        </li>
                                        <li Class="XmlExtensions.Setting.Text">
                                            <font>Tiny</font>
                                            <anchor>Left</anchor>
                                            <text>{mod}</text>
                                            <tag>{key}</tag>
                                        </li>
                                    </li>
                                    <!-- description -->
                                    <li>
                                        <li Class="XmlExtensions.Setting.SetColor">
                                            <color>(100,100,100)</color>
                                        </li>
                                        <li Class="XmlExtensions.Setting.Text">
                                            <font>Tiny</font>
                                            <!-- <font>Tiny</font> -->
                                            <text>{description}</text>
                                        </li>
                                    </li>
                                    <!-- default -->
                                    <li>
                                        <li Class="XmlExtensions.Setting.SetColor">
                                            <color>(100,100,100)</color>
                                        </li>
                                        <li Class="XmlExtensions.Setting.Text">
                                            <font>Tiny</font>
                                            <anchor>Right</anchor>
                                            <text>default: {default}</text>
                                        </li>
                                    </li>
                                </settings>
                            </li>
                            <li Class="XmlExtensions.Setting.SetColor">
                                <color>(60,60,60)</color>
                            </li>
                            <li Class="XmlExtensions.Setting.GapLine">
                                <spacing>-9</spacing>
                            </li>
                            <li Class="XmlExtensions.Setting.Gap">
                                <spacing>12</spacing>
                            </li>
                            <li Class="XmlExtensions.Setting.SetColor">
                                <color>(255,255,255)</color>
                            </li>
                        </caseTrue>
                    </li>
                </value>
            </Operation>


        </apply>
    </XmlExtensions.PatchDef>


    <!-- Logs the mod name -->
    <XmlExtensions.PatchDef Name="TP_ModLog" Abstract="True">
        <parameters>
            <li>mod</li>
            <li>color</li>
        </parameters>
        <apply>
            <Operation Class="XmlExtensions.OptionalPatch">
                <modId>carnap2.TPatches</modId>
                <key>TPatchesLogging</key>
                <defaultValue>false</defaultValue>
                <caseTrue>
                    <Operation Class="XmlExtensions.Conditional">
                        <xmlDoc>Log</xmlDoc>
                        <xpath>Log/settings/li[text="mod: {mod}"]</xpath>
                        <caseFalse>
                            <Operation Class="XmlExtensions.PatchOperationAdd">
                                <xmlDoc>Log</xmlDoc>
                                <order>Append</order>
                                <xpath>Log/settings</xpath>
                                <value>
                                    <li Class="XmlExtensions.Setting.SetColor">
                                        <color>{color}</color> <!-- (155,155,155) -->
                                    </li>
                                    <li Class="XmlExtensions.Setting.Text">
                                        <font>Tiny</font>
                                        <text>mod: {mod}</text>
                                    </li>
                                    <li Class="XmlExtensions.Setting.SetColor">
                                        <color>(255,255,255)</color> <!-- (155,155,155) -->
                                    </li>
                                </value>
                            </Operation>
                        </caseFalse>
                    </Operation>
                </caseTrue>
            </Operation>
        </apply>
    </XmlExtensions.PatchDef>


    <!-- checks if a single chosen mod is active and applies the appropriate patchdefs -->
    <XmlExtensions.PatchDef Name="TP_ModPatch" Abstract="True">
        <parameters>
            <li>key</li> <!-- key -->
            <li>mod</li> <!-- required mods -->
            <li>tab</li> <!-- tab - Fixes Tweaks Balancing Settings-->
            <li>label</li> <!-- label -->
            <li>description</li> <!-- description -->
            <li>tooltip</li> <!-- tooltip -->
            <li>default</li> <!-- ENABLED/DISABLED -->
        </parameters>
        <apply>

            <Operation Class="PatchOperationFindMod">
                <mods>
                    <li>{mod}</li>
                </mods>
                <match Class="PatchOperationSequence">
                    <operations>
                        <li Class="XmlExtensions.ApplyPatch">
                            <patchName>TP_ModBaseE</patchName>
                            <arguments>
                                <li>{key}</li> <!-- key -->
                                <li>{mod}</li> <!-- required mods -->
                                <li>{tab}</li> <!-- tab - Fixes Tweaks Balancing Settings-->
                                <li>{label}</li> <!-- label -->
                                <li>{description}</li> <!-- description -->
                                <li>{tooltip}</li> <!-- tooltip -->
                                <li>{default}</li> <!-- ENABLED/DISABLED -->
                                <li>(155,225,155)</li>
                                <li>0.11</li>
                                <li>0.8</li>
                                <li>TPatchesAlwaysOn</li>
                                <li>enabled</li>
                            </arguments>
                        </li>
                        <li Class="XmlExtensions.ApplyPatch">
                            <patchName>TP_ModLog</patchName>
                            <arguments>
                                <li>{mod}</li> <!-- required mods -->
                                <li>(255,255,255)</li>
                            </arguments>
                        </li>

                    </operations>
                </match>

                <nomatch Class="PatchOperationSequence">
                    <operations>
                        <li Class="XmlExtensions.ApplyPatch">
                            <patchName>TP_ModBaseD</patchName>
                            <arguments>
                                <li>{key}</li> <!-- key -->
                                <li>{mod}</li> <!-- required mods -->
                                <li>{tab}</li> <!-- tab - Fixes Tweaks Balancing Settings-->
                                <li>{label}</li> <!-- label -->
                                <li>{description}</li> <!-- description -->
                                <li>{tooltip}</li> <!-- tooltip -->
                                <li>{default}</li> <!-- ENABLED/DISABLED -->
                                <li>(175,105,105)</li>
                                <li>0.11</li>
                                <li>0.8</li>
                                <li>TPatchesAlwaysOn</li>
                                <li>disabled</li>
                            </arguments>
                        </li>
                        <li Class="XmlExtensions.ApplyPatch">
                            <patchName>TP_ModLog</patchName>
                            <arguments>
                                <li>{mod}</li> <!-- required mods -->
                                <li>(155,155,155)</li>
                            </arguments>
                        </li>

                    </operations>
                </nomatch>
            </Operation>
        </apply>
    </XmlExtensions.PatchDef>


    <!-- display more than one mod in a setting -->
    <XmlExtensions.PatchDef Name="TP_MultiDisplay" Abstract="True">
        <parameters>
            <li>key</li> <!-- key -->
            <li>mod</li> <!-- required mod -->
            <li>tab</li> <!-- tab where the setting is -->
        </parameters>
        <apply>
            <Operation Class="XmlExtensions.FindMod">
                <mods>
                    <li>{mod1}</li>
                    <li>{mod2}</li>
                </mods>
                <logic>{logic}</logic>
                <caseTrue>

                    <!-- mod is enabled -->
                    <!-- add mod name to setting -->
                    <Operation Class="XmlExtensions.PatchOperationInsert">
                        <xmlDoc>{tab}</xmlDoc>
                        <xpath>{tab}/settings/li/settings/li/caseTrue/li/settings/li/li[tag="{key}"]</xpath>
                        <value>
                            <li Class="XmlExtensions.Setting.SetColor">
                                <color>(155,225,155)</color>
                            </li>
                            <li Class="XmlExtensions.Setting.Text">
                                <font>Tiny</font>
                                <anchor>Left</anchor>
                                <text>{mod}</text>
                            </li>
                        </value>
                    </Operation>

                    <!-- log mod name -->
                    <Operation Class="XmlExtensions.Conditional">
                        <xmlDoc>Log</xmlDoc>
                        <xpath>Log/li/settings/li[text="mod: {mod}"]</xpath>
                        <caseFalse>
                            <Operation Class="XmlExtensions.PatchOperationAdd">
                                <xmlDoc>Log</xmlDoc>
                                <order>Append</order>
                                <xpath>Log/settings</xpath>
                                <value>
                                    <li Class="XmlExtensions.Setting.SetColor">
                                        <color>(255,255,255)</color> <!-- (155,155,155) -->
                                    </li>
                                    <li Class="XmlExtensions.Setting.Text">
                                        <font>Tiny</font>
                                        <text>mod: {mod}</text>
                                    </li>
                                </value>
                            </Operation>
                        </caseFalse>
                    </Operation>

                </caseTrue>


                <caseFalse>

                    <!-- mod is disabled -->
                    <!-- add mod name to setting -->
                    <Operation Class="XmlExtensions.PatchOperationInsert">
                        <xmlDoc>{tab}</xmlDoc>
                        <xpath>{tab}/settings/li/settings/li/caseTrue/li/settings/li/li[tag="{key}"]</xpath>
                        <value>
                            <li Class="XmlExtensions.Setting.SetColor">
                                <color>(175,105,105)</color>
                            </li>
                            <li Class="XmlExtensions.Setting.Text">
                                <font>Tiny</font>
                                <anchor>Left</anchor>
                                <text>{mod}</text>
                            </li>
                        </value>
                    </Operation>

                    <!-- log mod name -->
                    <Operation Class="XmlExtensions.Conditional">
                        <xmlDoc>Log</xmlDoc>
                        <xpath>Log/li/settings/li[text="mod: {mod}"]</xpath>
                        <caseFalse>
                            <Operation Class="XmlExtensions.PatchOperationAdd">
                                <xmlDoc>Log</xmlDoc>
                                <order>Append</order>
                                <xpath>Log/settings</xpath>
                                <value>
                                    <li Class="XmlExtensions.Setting.SetColor">
                                        <color>(155,155,155)</color> <!-- (155,155,155) -->
                                    </li>
                                    <li Class="XmlExtensions.Setting.Text">
                                        <font>Tiny</font>
                                        <text>mod: {mod}</text>
                                    </li>
                                    <li Class="XmlExtensions.Setting.SetColor">
                                        <color>(255,255,255)</color> <!-- (155,155,155) -->
                                    </li>
                                </value>
                            </Operation>
                        </caseFalse>
                    </Operation>

                </caseFalse>

            </Operation>
        </apply>
    </XmlExtensions.PatchDef>


    <!-- checks if 2 mods are active -->
    <XmlExtensions.PatchDef Name="TP_ModPatch2" Abstract="True">
        <parameters>
            <li>key</li> <!-- key -->
            <li>mod1</li> <!-- required mods -->
            <li>mod2</li> <!-- required mods -->
            <li>logic</li> <!-- or/and -->
            <li>tab</li> <!-- tab - Fixes Tweaks Balancing Settings-->
            <li>label</li> <!-- label -->
            <li>description</li> <!-- description -->
            <li>tooltip</li> <!-- tooltip -->
            <li>default</li> <!-- ENABLED/DISABLED -->
        </parameters>
        <apply>

            <Operation Class="XmlExtensions.FindMod">
                <mods>
                    <li>{mod1}</li>
                    <li>{mod2}</li>
                </mods>
                <logic>{logic}</logic>
                <caseTrue>

                    <!-- displays active setting -->
                    <Operation Class="XmlExtensions.ApplyPatch">
                        <patchName>TP_ModBaseE</patchName>
                        <arguments>
                            <li>{key}</li> <!-- key -->
                            <li>{mod1}</li> <!-- required mods -->
                            <li>{tab}</li> <!-- tab - Fixes Tweaks Balancing Settings-->
                            <li>{label}</li> <!-- label -->
                            <li>{description}</li> <!-- description -->
                            <li>{tooltip}</li> <!-- tooltip -->
                            <li>{default}</li> <!-- ENABLED/DISABLED -->
                            <li>(155,225,155)</li>
                            <li>0.15</li>
                            <li>0.76</li>
                            <li>TPatchesAlwaysOn</li>
                            <li>enabled</li>
                        </arguments>
                    </Operation>

                    <!-- adds multiple mods display -->
                    <Operation Class="XmlExtensions.ApplyPatch">
                        <patchName>TP_MultiDisplay</patchName>
                        <arguments>
                            <li>{key}</li> <!-- key -->
                            <li>{mod1}</li> <!-- required mod -->
                        </arguments>
                    </Operation>

                    <Operation Class="XmlExtensions.ApplyPatch">
                        <patchName>TP_MultiDisplay</patchName>
                        <arguments>
                            <li>{key}</li> <!-- key -->
                            <li>{mod2}</li> <!-- required mod -->
                        </arguments>
                    </Operation>

                    <!-- removes the original mod displayer -->
                    <Operation Class="XmlExtensions.PatchOperationRemove">
                        <xmlDoc>{tab}</xmlDoc>
                        <xpath>{tab}/settings/li/settings/li/caseTrue/li/settings/li/li[tag="{key}"]</xpath>
                    </Operation>

                </caseTrue>

                <caseFalse>

                    <Operation Class="XmlExtensions.ApplyPatch">
                        <patchName>TP_ModBaseD</patchName>
                        <arguments>
                            <li>{key}</li> <!-- key -->
                            <li>{mod1}</li> <!-- required mods -->
                            <li>{tab}</li> <!-- tab - Fixes Tweaks Balancing Settings-->
                            <li>{label}</li> <!-- label -->
                            <li>{description}</li> <!-- description -->
                            <li>{tooltip}</li> <!-- tooltip -->
                            <li>{default}</li> <!-- ENABLED/DISABLED -->
                            <li>(155,225,155)</li>
                            <li>0.15</li>
                            <li>0.76</li>
                            <li>TPatchesAlwaysOn</li>
                            <li>disabled</li>
                        </arguments>
                    </Operation>

                    <!-- adds multiple mods display -->
                    <Operation Class="XmlExtensions.ApplyPatch">
                        <patchName>TP_MultiDisplay</patchName>
                        <arguments>
                            <li>{key}</li> <!-- key -->
                            <li>{mod1}</li> <!-- required mod -->
                        </arguments>
                    </Operation>

                    <Operation Class="XmlExtensions.ApplyPatch">
                        <patchName>TP_MultiDisplay</patchName>
                        <arguments>
                            <li>{key}</li> <!-- key -->
                            <li>{mod2}</li> <!-- required mod -->
                        </arguments>
                    </Operation>

                    <!-- removes the original mod displayer -->
                    <Operation Class="PatchOperationRemove">
                        <xmlDoc>{tab}</xmlDoc>
                        <xpath>{tab}/settings/li/settings/li/caseTrue/li/settings/li/li[tag="{key}"]</xpath>
                    </Operation>

                </caseFalse>

            </Operation>
        </apply>
    </XmlExtensions.PatchDef>

    <!-- checks if 3 mods are active -->
    <XmlExtensions.PatchDef Name="TP_ModPatch3" Abstract="True">
        <parameters>
            <li>key</li> <!-- key -->
            <li>mod1</li> <!-- required mods -->
            <li>mod2</li> <!-- required mods -->
            <li>mod3</li> <!-- required mods -->
            <li>logic</li> <!-- or/and -->
            <li>tab</li> <!-- tab - Fixes Tweaks Balancing Settings-->
            <li>label</li> <!-- label -->
            <li>description</li> <!-- description -->
            <li>tooltip</li> <!-- tooltip -->
            <li>default</li> <!-- ENABLED/DISABLED -->
        </parameters>
        <apply>

            <Operation Class="XmlExtensions.FindMod">
                <mods>
                    <li>{mod1}</li>
                    <li>{mod2}</li>
                    <li>{mod3}</li>
                </mods>
                <logic>{logic}</logic>
                <caseTrue>

                    <!-- displays active setting -->
                    <Operation Class="XmlExtensions.ApplyPatch">
                        <patchName>TP_ModBaseE</patchName>
                        <arguments>
                            <li>{key}</li> <!-- key -->
                            <li>{mod1}</li> <!-- required mods -->
                            <li>{tab}</li> <!-- tab - Fixes Tweaks Balancing Settings-->
                            <li>{label}</li> <!-- label -->
                            <li>{description}</li> <!-- description -->
                            <li>{tooltip}</li> <!-- tooltip -->
                            <li>{default}</li> <!-- ENABLED/DISABLED -->
                            <li>(155,225,155)</li>
                            <li>0.15</li>
                            <li>0.76</li>
                            <li>TPatchesAlwaysOn</li>
                            <li>enabled</li>
                        </arguments>
                    </Operation>

                    <!-- adds multiple mods display -->
                    <Operation Class="XmlExtensions.ApplyPatch">
                        <patchName>TP_MultiDisplay</patchName>
                        <arguments>
                            <li>{key}</li> <!-- key -->
                            <li>{mod1}</li> <!-- required mod -->
                        </arguments>
                    </Operation>

                    <Operation Class="XmlExtensions.ApplyPatch">
                        <patchName>TP_MultiDisplay</patchName>
                        <arguments>
                            <li>{key}</li> <!-- key -->
                            <li>{mod2}</li> <!-- required mod -->
                        </arguments>
                    </Operation>

                    <Operation Class="XmlExtensions.ApplyPatch">
                        <patchName>TP_MultiDisplay</patchName>
                        <arguments>
                            <li>{key}</li> <!-- key -->
                            <li>{mod3}</li> <!-- required mod -->
                        </arguments>
                    </Operation>

                    <!-- removes the original mod displayer -->
                    <Operation Class="XmlExtensions.PatchOperationRemove">
                        <xmlDoc>{tab}</xmlDoc>
                        <xpath>{tab}/settings/li/settings/li/caseTrue/li/settings/li/li[tag="{key}"]</xpath>
                    </Operation>

                </caseTrue>

                <caseFalse>

                    <Operation Class="XmlExtensions.ApplyPatch">
                        <patchName>TP_ModBaseD</patchName>
                        <arguments>
                            <li>{key}</li> <!-- key -->
                            <li>{mod1}</li> <!-- required mods -->
                            <li>{tab}</li> <!-- tab - Fixes Tweaks Balancing Settings-->
                            <li>{label}</li> <!-- label -->
                            <li>{description}</li> <!-- description -->
                            <li>{tooltip}</li> <!-- tooltip -->
                            <li>{default}</li> <!-- ENABLED/DISABLED -->
                            <li>(155,225,155)</li>
                            <li>0.15</li>
                            <li>0.76</li>
                            <li>TPatchesAlwaysOn</li>
                            <li>disabled</li>
                        </arguments>
                    </Operation>

                    <!-- adds multiple mods display -->
                    <Operation Class="XmlExtensions.ApplyPatch">
                        <patchName>TP_MultiDisplay</patchName>
                        <arguments>
                            <li>{key}</li> <!-- key -->
                            <li>{mod1}</li> <!-- required mod -->
                        </arguments>
                    </Operation>

                    <Operation Class="XmlExtensions.ApplyPatch">
                        <patchName>TP_MultiDisplay</patchName>
                        <arguments>
                            <li>{key}</li> <!-- key -->
                            <li>{mod2}</li> <!-- required mod -->
                        </arguments>
                    </Operation>

                    <Operation Class="XmlExtensions.ApplyPatch">
                        <patchName>TP_MultiDisplay</patchName>
                        <arguments>
                            <li>{key}</li> <!-- key -->
                            <li>{mod3}</li> <!-- required mod -->
                        </arguments>
                    </Operation>

                    <!-- removes the original mod displayer -->
                    <Operation Class="XmlExtensions.PatchOperationRemove">
                        <xmlDoc>{tab}</xmlDoc>
                        <xpath>{tab}/settings/li/settings/li/caseTrue/li/settings/li/li[tag="{key}"]</xpath>
                    </Operation>

                </caseFalse>

            </Operation>
        </apply>
    </XmlExtensions.PatchDef>


    <!-- checks if 4 mods are active -->
    <XmlExtensions.PatchDef Name="TP_ModPatch4" Abstract="True">
        <parameters>
            <li>key</li> <!-- key -->
            <li>mod1</li> <!-- required mods -->
            <li>mod2</li> <!-- required mods -->
            <li>mod3</li> <!-- required mods -->
            <li>mod4</li> <!-- required mods -->
            <li>logic</li> <!-- or/and -->
            <li>tab</li> <!-- tab - Fixes Tweaks Balancing Settings-->
            <li>label</li> <!-- label -->
            <li>description</li> <!-- description -->
            <li>tooltip</li> <!-- tooltip -->
            <li>default</li> <!-- ENABLED/DISABLED -->
        </parameters>
        <apply>

            <Operation Class="XmlExtensions.FindMod">
                <mods>
                    <li>{mod1}</li>
                    <li>{mod2}</li>
                    <li>{mod3}</li>
                    <li>{mod4}</li>
                </mods>
                <logic>{logic}</logic>
                <caseTrue>

                    <!-- displays active setting -->
                    <Operation Class="XmlExtensions.ApplyPatch">
                        <patchName>TP_ModBaseE</patchName>
                        <arguments>
                            <li>{key}</li> <!-- key -->
                            <li>{mod1}</li> <!-- required mods -->
                            <li>{tab}</li> <!-- tab - Fixes Tweaks Balancing Settings-->
                            <li>{label}</li> <!-- label -->
                            <li>{description}</li> <!-- description -->
                            <li>{tooltip}</li> <!-- tooltip -->
                            <li>{default}</li> <!-- ENABLED/DISABLED -->
                            <li>(155,225,155)</li>
                            <li>0.15</li>
                            <li>0.76</li>
                            <li>TPatchesAlwaysOn</li>
                            <li>enabled</li>
                        </arguments>
                    </Operation>

                    <!-- adds multiple mods display -->
                    <Operation Class="XmlExtensions.ApplyPatch">
                        <patchName>TP_MultiDisplay</patchName>
                        <arguments>
                            <li>{key}</li> <!-- key -->
                            <li>{mod1}</li> <!-- required mod -->
                        </arguments>
                    </Operation>

                    <Operation Class="XmlExtensions.ApplyPatch">
                        <patchName>TP_MultiDisplay</patchName>
                        <arguments>
                            <li>{key}</li> <!-- key -->
                            <li>{mod2}</li> <!-- required mod -->
                        </arguments>
                    </Operation>

                    <Operation Class="XmlExtensions.ApplyPatch">
                        <patchName>TP_MultiDisplay</patchName>
                        <arguments>
                            <li>{key}</li> <!-- key -->
                            <li>{mod3}</li> <!-- required mod -->
                        </arguments>
                    </Operation>

                    <Operation Class="XmlExtensions.ApplyPatch">
                        <patchName>TP_MultiDisplay</patchName>
                        <arguments>
                            <li>{key}</li> <!-- key -->
                            <li>{mod4}</li> <!-- required mod -->
                        </arguments>
                    </Operation>

                    <!-- removes the original mod displayer -->
                    <Operation Class="XmlExtensions.PatchOperationRemove">
                        <xmlDoc>{tab}</xmlDoc>
                        <xpath>{tab}/settings/li/settings/li/caseTrue/li/settings/li/li[tag="{key}"]</xpath>
                    </Operation>

                </caseTrue>

                <caseFalse>

                    <Operation Class="XmlExtensions.ApplyPatch">
                        <patchName>TP_ModBaseD</patchName>
                        <arguments>
                            <li>{key}</li> <!-- key -->
                            <li>{mod1}</li> <!-- required mods -->
                            <li>{tab}</li> <!-- tab - Fixes Tweaks Balancing Settings-->
                            <li>{label}</li> <!-- label -->
                            <li>{description}</li> <!-- description -->
                            <li>{tooltip}</li> <!-- tooltip -->
                            <li>{default}</li> <!-- ENABLED/DISABLED -->
                            <li>(155,225,155)</li>
                            <li>0.15</li>
                            <li>0.76</li>
                            <li>TPatchesAlwaysOn</li>
                            <li>disabled</li>
                        </arguments>
                    </Operation>

                    <!-- adds multiple mods display -->
                    <Operation Class="XmlExtensions.ApplyPatch">
                        <patchName>TP_MultiDisplay</patchName>
                        <arguments>
                            <li>{key}</li> <!-- key -->
                            <li>{mod1}</li> <!-- required mod -->
                        </arguments>
                    </Operation>

                    <Operation Class="XmlExtensions.ApplyPatch">
                        <patchName>TP_MultiDisplay</patchName>
                        <arguments>
                            <li>{key}</li> <!-- key -->
                            <li>{mod2}</li> <!-- required mod -->
                        </arguments>
                    </Operation>

                    <Operation Class="XmlExtensions.ApplyPatch">
                        <patchName>TP_MultiDisplay</patchName>
                        <arguments>
                            <li>{key}</li> <!-- key -->
                            <li>{mod3}</li> <!-- required mod -->
                        </arguments>
                    </Operation>

                    <Operation Class="XmlExtensions.ApplyPatch">
                        <patchName>TP_MultiDisplay</patchName>
                        <arguments>
                            <li>{key}</li> <!-- key -->
                            <li>{mod4}</li> <!-- required mod -->
                        </arguments>
                    </Operation>

                    <!-- removes the original mod displayer -->
                    <Operation Class="XmlExtensions.PatchOperationRemove">
                        <xmlDoc>{tab}</xmlDoc>
                        <xpath>{tab}/settings/li/settings/li/caseTrue/li/settings/li/li[tag="{key}"]</xpath>
                    </Operation>

                </caseFalse>

            </Operation>
        </apply>
    </XmlExtensions.PatchDef>


    <!-- a simple toggle for groups -->
    <XmlExtensions.PatchDef Name="TP_Toggle" Abstract="True">
        <parameters>
            <li>key</li> <!-- key -->
            <li>tab</li> <!-- tab - Fixes Tweaks Balancing Settings-->
            <li>label</li> <!-- label -->
            <li>tooltip</li> <!-- tooltip -->
        </parameters>
        <apply>

            <Operation Class="XmlExtensions.PatchOperationAdd">
                <xmlDoc>{tab}</xmlDoc>
                <order>Append</order>
                <xpath>{tab}/settings/li[tag="enabled"]/settings</xpath>
                <value>
                    <li Class="XmlExtensions.Setting.Gap">
                        <spacing>1</spacing>
                    </li>
                    <li Class="XmlExtensions.Setting.Checkbox">
                        <key>{key}</key>
                        <label>{label}</label>
                        <tooltip>{tooltip}</tooltip>
                    </li>

                </value>
            </Operation>

        </apply>
    </XmlExtensions.PatchDef>


    <!-- shows only when a given key is true. checks if a single chosen mod is active and applies the appropriate patchdefs -->
    <XmlExtensions.PatchDef Name="TP_ModPatchGrouped" Abstract="True">
        <parameters>
            <li>key</li> <!-- key -->
            <li>mod</li> <!-- required mods -->
            <li>tab</li> <!-- tab - Fixes Tweaks Balancing Settings-->
            <li>label</li> <!-- label -->
            <li>description</li> <!-- description -->
            <li>tooltip</li> <!-- tooltip -->
            <li>default</li> <!-- ENABLED/DISABLED -->
            <li>group</li> <!-- key of the setting that shows this -->
        </parameters>
        <apply>

            <Operation Class="PatchOperationFindMod">
                <mods>
                    <li>{mod}</li>
                </mods>
                <match Class="PatchOperationSequence">
                    <operations>
                        <li Class="XmlExtensions.ApplyPatch">
                            <patchName>TP_ModBaseE</patchName>
                            <arguments>
                                <li>{key}</li> <!-- key -->
                                <li>{mod}</li> <!-- required mods -->
                                <li>{tab}</li> <!-- tab - Fixes Tweaks Balancing Settings-->
                                <li>{label}</li> <!-- label -->
                                <li>{description}</li> <!-- description -->
                                <li>{tooltip}</li> <!-- tooltip -->
                                <li>{default}</li> <!-- ENABLED/DISABLED -->
                                <li>(155,225,155)</li>
                                <li>0.11</li>
                                <li>0.8</li>
                                <li>{group}</li>
                                <li>enabled</li>
                            </arguments>
                        </li>
                        <li Class="XmlExtensions.ApplyPatch">
                            <patchName>TP_ModLog</patchName>
                            <arguments>
                                <li>{mod}</li> <!-- required mods -->
                                <li>(255,255,255)</li>
                            </arguments>
                        </li>

                    </operations>
                </match>

                <nomatch Class="PatchOperationSequence">
                    <operations>
                        <li Class="XmlExtensions.ApplyPatch">
                            <patchName>TP_ModBaseD</patchName>
                            <arguments>
                                <li>{key}</li> <!-- key -->
                                <li>{mod}</li> <!-- required mods -->
                                <li>{tab}</li> <!-- tab - Fixes Tweaks Balancing Settings-->
                                <li>{label}</li> <!-- label -->
                                <li>{description}</li> <!-- description -->
                                <li>{tooltip}</li> <!-- tooltip -->
                                <li>{default}</li> <!-- ENABLED/DISABLED -->
                                <li>(175,105,105)</li>
                                <li>0.11</li>
                                <li>0.8</li>
                                <li>{group}</li>
                                <li>enabled</li>
                            </arguments>
                        </li>
                        <li Class="XmlExtensions.ApplyPatch">
                            <patchName>TP_ModLog</patchName>
                            <arguments>
                                <li>{mod}</li> <!-- required mods -->
                                <li>(155,155,155)</li>
                            </arguments>
                        </li>

                    </operations>
                </nomatch>
            </Operation>
        </apply>
    </XmlExtensions.PatchDef>


    <!-- creates a tab -->
    <XmlExtensions.PatchDef Name="TP_Tab" Abstract="True">
        <parameters>
            <li>tab</li>
            <li>description</li>
        </parameters>
        <apply>

            <Operation Class="XmlExtensions.PatchOperationInsert">
                <order>Prepend</order>
                <xpath>Defs/XmlExtensions.SettingsMenuDef[defName="TPatches_SettingsMenu"]/settings/li/tabs/li[label="Log"]</xpath>
                <value>
                    <li>
                        <label>{tab}</label>
                        <settings>
                            <!--<li Class="XmlExtensions.Setting.Group">
                                    <settings>-->

                            <!-- description -->
                            <li Class="XmlExtensions.Setting.SetColor">
                                <color>(255,255,255)</color>
                            </li>
                            <li Class="XmlExtensions.Setting.Text">
                                <font>Tiny</font>
                                <text>{description}</text>
                            </li>
                            <li Class="XmlExtensions.Setting.GapLine">
                                <spacing>0</spacing>
                            </li>
                            <li Class="XmlExtensions.Setting.GapLine">
                                <spacing>1</spacing>
                            </li>
                            <li Class="XmlExtensions.Setting.GapLine">
                                <spacing>0</spacing>
                            </li>
                            <li Class="XmlExtensions.Setting.GapLine">
                                <spacing>1</spacing>
                            </li>
                            <li Class="XmlExtensions.Setting.GapLine">
                                <spacing>0</spacing>
                            </li>
                            <li Class="XmlExtensions.Setting.GapLine">
                                <spacing>1</spacing>
                            </li>
                            <li Class="XmlExtensions.Setting.Gap">
                                <spacing>8</spacing>
                            </li>

                            <!-- enabled mods -->
                            <li Class="XmlExtensions.Setting.Group">
                                <tag>enabled</tag>
                                <settings></settings>
                            </li>

                            <!-- disabled mods -->
                            <li Class="XmlExtensions.Setting.Group">
                                <tag>disabled</tag>
                                <settings>
                                    <li Class="XmlExtensions.Setting.Gap">
                                        <spacing>17.1</spacing>
                                    </li>
                                    <li Class="XmlExtensions.Setting.SetColor">
                                        <color>(195,195,195)</color>
                                    </li>
                                    <li Class="XmlExtensions.Setting.Text">
                                        <font>Tiny</font>
                                        <text>Settings for mods that aren't installed in your game. It is safe to enable them, but they will have no effect.</text>
                                    </li>
                                    <li Class="XmlExtensions.Setting.SetColor">
                                        <color>(90,90,90)</color>
                                    </li>
                                    <li Class="XmlExtensions.Setting.GapLine">
                                        <spacing>0</spacing>
                                    </li>
                                    <li Class="XmlExtensions.Setting.GapLine">
                                        <spacing>1</spacing>
                                    </li>
                                    <li Class="XmlExtensions.Setting.GapLine">
                                        <spacing>0</spacing>
                                    </li>
                                    <li Class="XmlExtensions.Setting.GapLine">
                                        <spacing>1</spacing>
                                    </li>
                                    <li Class="XmlExtensions.Setting.GapLine">
                                        <spacing>0</spacing>
                                    </li>
                                    <li Class="XmlExtensions.Setting.GapLine">
                                        <spacing>1</spacing>
                                    </li>
                                    <li Class="XmlExtensions.Setting.Gap">
                                        <spacing>9</spacing>
                                    </li>

                                </settings>
                            </li>
                            <!--</settings>
                                    </li>-->

                        </settings>
                    </li>
                </value>
            </Operation>

            <Operation Class="XmlExtensions.CreateDocument">
                <docName>{tab}</docName>
                <xpath>Defs/XmlExtensions.SettingsMenuDef[defName="TPatches_SettingsMenu"]/settings/li/tabs/li[label="{tab}"]/settings</xpath>
            </Operation>

        </apply>
    </XmlExtensions.PatchDef>
</Defs>