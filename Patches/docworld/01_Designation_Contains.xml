<?xml version="1.0" encoding="utf-8"?>

<Patch>
    <Operation Class="XmlExtensions.OptionalPatch">
        <modId>carnap2.TPatches</modId>
        <key>DocWorld_DesignationCategories</key>
        <defaultValue>true</defaultValue>
        <caseTrue>

            <!-- stopwatch -->
            <Operation Class="XmlExtensions.OptionalPatch">
                <modId>carnap2.TPatches</modId>
                <key>TPatchesLogging</key>
                <defaultValue>false</defaultValue>
                <caseTrue>
                    <Operation Class="XmlExtensions.Log">
                        <text>Stopwatch: Docworld - contains</text>
                    </Operation>
                    <Operation Class="XmlExtensions.StopwatchStart" />
                </caseTrue>
            </Operation>

            <!-- document -->
            <Operation Class="XmlExtensions.CreateDocument">
                <docName>Designations</docName>
                <xpath>Defs/ThingDef[
                    designationCategory[normalize-space()] or 

                    @ParentName="LampBase" or 
                    @ParentName="StandingLampBase" or
                    @ParentName="FurnitureBase" or
                    @ParentName="FurnitureWithQualityBase" or
                    @ParentName="ArtableFurnitureBase" or
                    @ParentName="ArtableFurnitureRegardlessOfQualityBase" or
                    @ParentName="TableBase" or
                    @ParentName="BaseArtilleryBuilding" or 
                    @ParentName="AutocannonTurret" or 
                    @ParentName="NatureShrineBase" or 
                    @ParentName="IdeoBuildingBase" or
                    @ParentName="AltarBase" or
                    @ParentName="IdeoBuildingConsumableBase" or
                    @ParentName="IdeoBurnableBase" or
                    @ParentName="IdeoSmokerBase"
                    
                    ]</xpath>
            </Operation>

            <!-- vanilla groups -->
            <!-- FURNITURE -->
            <Operation Class="XmlExtensions.PatchOperationAddOrReplace">
                <success>Always</success>
                <xmlDoc>Designations</xmlDoc>
                <xpath>
                    Designations/ThingDef[
                    <!-- LTS -->
                    designationCategory="LTSFurniture" or
                    <!-- VE -->
                    designationCategory="AOMorefurniture" or
                    <!-- MO -->
                    designationCategory="DankPyon_RusticFurniture"
                    ]
                </xpath>
                <value>
                    <designationCategory>Furniture</designationCategory>
                </value>
            </Operation>
            <!-- STRUCTURE -->
            <Operation Class="XmlExtensions.PatchOperationAddOrReplace">
                <success>Always</success>
                <xmlDoc>Designations</xmlDoc>
                <xpath>
                    Designations/ThingDef[
                    <!-- LTS -->
                    designationCategory="LTSStructure"
                    ]
                </xpath>
                <value>
                    <designationCategory>Structure</designationCategory>
                </value>
            </Operation>
            <!-- JOY -->
            <Operation Class="XmlExtensions.PatchOperationAddOrReplace">
                <success>Always</success>
                <xmlDoc>Designations</xmlDoc>
                <xpath>
                    Designations/ThingDef[
                    <!-- LTS -->
                    @Name="LTS_TabletopBase" or
                    <!-- VE -->
                    defName="UltrascreenTV"
                    ]
                </xpath>
                <value>
                    <designationCategory>Joy</designationCategory>
                </value>
            </Operation>
            <!-- TMPERATURE -->
            <Operation Class="XmlExtensions.PatchOperationAddOrReplace">
                <success>Always</success>
                <xmlDoc>Designations</xmlDoc>
                <xpath>
                    Designations/ThingDef[
                    <!-- MO -->
                    defName="DankPyon_WoodBurningStove" or
                    defName="DankPyon_RusticHearth"
                    ]
                </xpath>
                <value>
                    <designationCategory>Temperature</designationCategory>
                </value>
            </Operation>
            <!-- PRODUCTION -->
            <!--
            <Operation Class="XmlExtensions.PatchOperationAddOrReplace">
                <success>Always</success>
                <xmlDoc>Designations</xmlDoc>
                <xpath>Designations/ThingDef[

                    
                    ]</xpath>
                <value>
                    <designationCategory>Production</designationCategory>
                </value>
            </Operation>
        -->


            <!-- culinary -->
            <Operation Class="XmlExtensions.OptionalPatch">
                <modId>carnap2.TPatches</modId>
                <key>DocWorld_DesignationCategoriesCulinary</key>
                <defaultValue>true</defaultValue>
                <caseTrue>

                    <Operation Class="PatchOperationAdd">
                        <xpath>Defs</xpath>
                        <value>
                            <DesignationCategoryDef>
                                <defName>DZ_Culinary</defName>
                                <label>Culinary</label>
                                <description>Cooking and fermenting.</description>
                                <order>590</order>
                                <specialDesignatorClasses>
                                    <li>Designator_Cancel</li>
                                    <li>Designator_Deconstruct</li>
                                    <li>Designator_Uninstall</li>
                                </specialDesignatorClasses>
                            </DesignationCategoryDef>
                        </value>
                    </Operation>

                    <Operation Class="XmlExtensions.PatchOperationAddOrReplace">
                        <xmlDoc>Designations</xmlDoc>
                        <xpath>
                            Designations/ThingDef[
                            <!-- definitely doesn't have any of the parent names that are in the doc, so I filter them out right away, and whitelist is also filtered. -->
                            designationCategory and 

                            (not(
                            <!-- CULINARY BLACKLIST -->
                            defName="GR_NutrientVat"
                            
                            ))]
                            [
                            contains(label, "stove") or 
                            contains(label, "Stove") or 
                            contains(@Name, "stove") or 
                            contains(@Name, "Stove") or
                            contains(label, "ferment") or 
                            contains(label, "Ferment") or 
                            contains(@Name, "ferment") or 
                            contains(@Name, "Ferment") or 
                            contains(label, "nutrient") or 
                            contains(label, "Nutrient") or 
                            contains(@Name, "nutrient") or 
                            contains(@Name, "Nutrient") or 
                            contains(label, "butcher") or 
                            contains(label, "Butcher") or 
                            contains(@Name, "butcher") or 
                            contains(@Name, "Butcher") or
                            thingClass="Building_FermentingBarrel" or
                            <!-- CULINARY WHITELIST -->
                            <!-- alpha memes -->
                            defName="AM_GrogDispenser" or
                            <!-- replimat -->
                            designationCategory="Replimat_Replimat" or
                            <!-- rimbees -->
                            defName="RB_Beekeeping_Workbench_Building" or
                            <!-- VFEC -->
                            defName="VFEC_MeatDryingRack" or
                            <!-- VPEMP -->
                            defName="VCE_VegMilkExtractor" or
                            <!-- more linkables -->
                            defName="KitchenCupboard" or
                            <!-- rimstro -->
                            designationCategory="RS_Category" or
                            <!-- VFES -->
                            defName="Building_ChemshineBarrel" or
                            <!-- VFEM -->
                            defName="VFEM_WineBarrel" or
                            <!-- VFEP -->
                            defName="VFE_TableStoveLarge" or 
                            defName="VFE_TableButcherElectric" or 
                            defName="VPE_GasStove" or
                            <!-- VFEV -->
                            defName="VFEV_MeadFermentingBarrel" or
                            <!-- VCES -->
                            defName="VCE_SushiPrepTable" or 
                            defName="VCE_SoyFermenter" or
                            <!-- VCES -->
                            defName="VCE_StewPot" or
                            <!-- VCE -->
                            defName="VCE_CheesePress" or 
                            defName="VCE_CondimentPrepTable" or 
                            defName="VCE_CanningMachine" or 
                            defName="VCE_DeepFrier" or 
                            defName="VCE_ElectricPot" or 
                            defName="VCE_Grill" or
                            <!-- VBECaT -->
                            defName="VBE_EspressoMachineBuilding" or 
                            <!-- VBE -->
                            defName="VBE_Bar" or 
                            defName="VBE_SodaFountain" or 
                            defName="VBE_AmbrandyDistillery" or 
                            defName="VBE_WhiskeyCask" or 
                            defName="VBE_TequilaBarrel" or 
                            defName="VBE_VodkaDrum" or 
                            defName="VBE_GinStill" or
                            <!-- universal fermenter -->
                            defName="UniversalFermenter"
                            ]
                        </xpath>
                        <value>
                            <designationCategory>DZ_Culinary</designationCategory>
                        </value>
                    </Operation>

                </caseTrue>
            </Operation>

            <!-- lighting -->
            <Operation Class="XmlExtensions.OptionalPatch">
                <modId>carnap2.TPatches</modId>
                <key>DocWorld_DesignationCategoriesLighting</key>
                <defaultValue>true</defaultValue>
                <caseTrue>

                    <Operation Class="PatchOperationAdd">
                        <xpath>Defs</xpath>
                        <value>
                            <DesignationCategoryDef>
                                <defName>DZ_Lighting</defName>
                                <label>Lighting</label>
                                <description>Illumination.</description>
                                <order>480</order>
                                <specialDesignatorClasses>
                                    <li>Designator_Cancel</li>
                                    <li>Designator_Deconstruct</li>
                                    <li>Designator_Uninstall</li>
                                </specialDesignatorClasses>
                            </DesignationCategoryDef>
                        </value>
                    </Operation>

                    <Operation Class="XmlExtensions.PatchOperationAddOrReplace">
                        <xmlDoc>Designations</xmlDoc>
                        <xpath>
                            Designations/ThingDef[

                        @ParentName="LampBase" or 
                        @ParentName="StandingLampBase" or
                        contains(label, "lamp") or 
                        contains(label, "torch") or 
                        contains(label, "Lamp") or 
                        contains(label, "Torch") or 
                        contains(label, "wall light") or 
                        contains(label, "Wall light") or 
                        contains(@Name, "lamp") or 
                        contains(@Name, "torch") or 
                        contains(@Name, "Lamp") or 
                        contains(@Name, "Torch") or
                        contains(label, "lantern") or 
                        contains(label, "Lantern") or 
                        contains(@Name, "lantern") or 
                        contains(@Name, "Lantern") or
                            <!-- LIGHTING WHITELIST -->
                            @Name="LTS_LightBase"
                        
                        ]
                        </xpath>
                        <value>
                            <designationCategory>DZ_Lighting</designationCategory>
                        </value>
                    </Operation>

                </caseTrue>
            </Operation>

            <!-- bedroom -->
            <Operation Class="XmlExtensions.OptionalPatch">
                <modId>carnap2.TPatches</modId>
                <key>DocWorld_DesignationCategoriesBeds</key>
                <defaultValue>true</defaultValue>
                <caseTrue>

                    <Operation Class="PatchOperationAdd">
                        <xpath>Defs</xpath>
                        <value>
                            <DesignationCategoryDef>
                                <defName>DZ_Beds</defName>
                                <label>Bedroom</label>
                                <description>Spots for your pawns to rest.</description>
                                <order>490</order>
                                <specialDesignatorClasses>
                                    <li>Designator_Cancel</li>
                                    <li>Designator_Deconstruct</li>
                                    <li>Designator_Uninstall</li>
                                </specialDesignatorClasses>
                            </DesignationCategoryDef>
                        </value>
                    </Operation>


                    <Operation Class="XmlExtensions.PatchOperationAddOrReplace">
                        <xmlDoc>Designations</xmlDoc>
                        <xpath>
                            <!-- buildings with bed nodes -->
                            Designations/ThingDef[designationCategory or 
                            @ParentName="FurnitureBase" or
                            @ParentName="FurnitureWithQualityBase" or
                            @ParentName="ArtableFurnitureBase" or
                            @ParentName="ArtableFurnitureRegardlessOfQualityBase"]
                                    
                            [comps/li/compClass="CompAssignableToPawn_Bed" or 
                            thingClass="Building_Bed" or 
                            building/buildingTags/li="Bed"]

                            |
                            <!-- straightforward beds -->
                            Designations/ThingDef[@ParentName="BedBase" or
                            @ParentName="BedWithQualityBase" or 
                            @ParentName="ArtableBedBase"]

                            |
                            <!-- linkables -->
                            Designations/ThingDef[
                            designationCategory or 
                            @ParentName="FurnitureBase" or
                            @ParentName="FurnitureWithQualityBase" or
                            @ParentName="ArtableFurnitureBase" or
                            @ParentName="ArtableFurnitureRegardlessOfQualityBase" or
                            @ParentName="TableBase"
                            ][comps/li[@Class="CompProperties_Facility"]][
                            contains(label, "dresser") or 
                            contains(label, "Dresser") or 
                            contains(@Name, "dresser") or 
                            contains(@Name, "Dresser") or
                            contains(label, "end table") or 
                            contains(label, "End table") or 
                            contains(@Name, "EndTable") or 
                            contains(@Name, "Endtable") or
                            contains(label, "wardrobe") or 
                            contains(label, "Wardrobe") or 
                            contains(@Name, "wardrobe") or 
                            contains(@Name, "Wardrobe") or 
                            contains(label, "bed") or 
                            contains(label, "Bed") or 
                            contains(@Name, "bed") or 
                            contains(@Name, "Bed")]

                            |
                            <!-- BEDROOM WHITELIST -->
                            Designations/ThingDef[
                            <!-- not in doc anymore
                            defName="LTS_KoppangD" or 
                            defName="LTS_IdanasN" or 
                            defName="LTS_IdanasD" or 
                            -->
                            @Name="LTS_BedBase" or 
                            @Name="LTS_ArtBedBase"
                            
                            ]
                            <!--
                            [
                            contains(label, "sleep") or 
                            contains(label, "Sleep") or 
                            contains(@Name, "sleep") or 
                            contains(@Name, "Sleep") or
                            contains(label, "bed") or 
                            contains(label, "Bed") or 
                            contains(@Name, "bed") or 
                            contains(@Name, "Bed")]
                            -->
                        </xpath>
                        <value>
                            <designationCategory>DZ_Beds</designationCategory>
                        </value>
                    </Operation>

                </caseTrue>
            </Operation>


            <!-- storage -->
            <Operation Class="XmlExtensions.OptionalPatch">
                <modId>carnap2.TPatches</modId>
                <key>DocWorld_DesignationCategoriesStorage</key>
                <defaultValue>false</defaultValue>
                <caseTrue>

                    <Operation Class="PatchOperationAdd">
                        <xpath>Defs</xpath>
                        <value>
                            <DesignationCategoryDef>
                                <defName>DZ_Storage</defName>
                                <label>Storage</label>
                                <description>Furniture that can store items.</description>
                                <order>470</order>
                                <specialDesignatorClasses>
                                    <li>Designator_Cancel</li>
                                    <li>Designator_Deconstruct</li>
                                    <li>Designator_Uninstall</li>
                                </specialDesignatorClasses>
                            </DesignationCategoryDef>
                        </value>
                    </Operation>


                    <Operation Class="XmlExtensions.PatchOperationAddOrReplace">
                        <xmlDoc>Designations</xmlDoc>
                        <xpath>Designations/ThingDef[
                                    designationCategory or 
                                    @ParentName="FurnitureBase" or
                                    @ParentName="FurnitureWithQualityBase" or
                                    @ParentName="ArtableFurnitureBase" or
                                    @ParentName="ArtableFurnitureRegardlessOfQualityBase"
                                    ][
                                    building/fixedStorageSettings/filter/categories/li="Root"]</xpath>
                        <value>
                            <designationCategory>DZ_Storage</designationCategory>
                        </value>
                    </Operation>
                </caseTrue>
            </Operation>

            <!-- turrets -->
            <Operation Class="XmlExtensions.OptionalPatch">
                <modId>carnap2.TPatches</modId>
                <key>DocWorld_DesignationCategoriesTurrets</key>
                <defaultValue>true</defaultValue>
                <caseTrue>

                    <Operation Class="PatchOperationAdd">
                        <xpath>Defs</xpath>
                        <value>
                            <DesignationCategoryDef>
                                <defName>DZ_Turrets</defName>
                                <label>Turrets</label>
                                <description>Defensive turrets.</description>
                                <order>290</order>
                                <specialDesignatorClasses>
                                    <li>Designator_Cancel</li>
                                    <li>Designator_Deconstruct</li>
                                    <li>Designator_Uninstall</li>
                                </specialDesignatorClasses>
                            </DesignationCategoryDef>
                        </value>
                    </Operation>


                    <Operation Class="XmlExtensions.PatchOperationAddOrReplace">
                        <xmlDoc>Designations</xmlDoc>
                        <xpath>
                            Designations/ThingDef[
                                    (
                                    designationCategory and 
                                    (thingClass="Building_TurretGun" or statBases/ShootingAccuracyTurret or building/buildingTags/li="Artillery" or building/turretBurstWarmupTime or building/turretBurstCooldownTime or building/turretGunDef or building/turretTopDrawSize)
                                    ) 
                                    or @ParentName="BaseArtilleryBuilding" or @ParentName="AutocannonTurret"
                                    ][
                            <!-- TURRETS BLACKLIST -->
                            not(defName="VFES_Turret_Decoy")
                                    
                                    ]
                        </xpath>
                        <value>
                            <designationCategory>DZ_Turrets</designationCategory>
                        </value>
                    </Operation>
                </caseTrue>
            </Operation>


            <!-- husbandry -->
            <Operation Class="XmlExtensions.OptionalPatch">
                <modId>carnap2.TPatches</modId>
                <key>DocWorld_DesignationCategoriesHusbandry</key>
                <defaultValue>true</defaultValue>
                <caseTrue>

                    <Operation Class="PatchOperationAdd">
                        <xpath>Defs</xpath>
                        <value>
                            <DesignationCategoryDef>
                                <defName>DZ_Husbandry</defName>
                                <label>Husbandry</label>
                                <description>For all your agricultural and livestock needs.</description>
                                <order>580</order>
                                <specialDesignatorClasses>
                                    <li>Designator_Cancel</li>
                                    <li>Designator_Deconstruct</li>
                                    <li>Designator_Uninstall</li>
                                    <li>Designator_SmoothSurface</li>
                                    <li>Designator_RemoveFloor</li>
                                </specialDesignatorClasses>
                            </DesignationCategoryDef>
                        </value>
                    </Operation>

                    <Operation Class="XmlExtensions.PatchOperationAddOrReplace">
                        <xmlDoc>Designations</xmlDoc>
                        <xpath>
                            Designations/ThingDef[designationCategory or @ParentName="LampBase"][
                            contains(label, "hydroponic") or 
                            contains(label, "sun") or 
                            contains(label, "Hydroponic") or 
                            contains(label, "Sun") or 
                            contains(@Name, "hydroponic") or 
                            contains(@Name, "sun") or 
                            contains(@Name, "Hydroponic") or 
                            contains(@Name, "Sun") or
                            thingClass="Building_PlantGrower" or 
                            thingClass="Building_SunLamp" or 
                            building/defaultPlantToGrow]
                        
                        |
                    
                        Designations/ThingDef[
                            <!-- HUSBANDRY WHITELIST -->
                            @Name="LTS_GrowingBase"
                        
                        ]
                        </xpath>
                        <value>
                            <designationCategory>DZ_Husbandry</designationCategory>
                        </value>
                    </Operation>

                </caseTrue>
            </Operation>

            <!-- medical -->
            <Operation Class="XmlExtensions.OptionalPatch">
                <modId>carnap2.TPatches</modId>
                <key>DocWorld_DesignationCategoriesMedical</key>
                <defaultValue>false</defaultValue>
                <caseTrue>


                    <Operation Class="PatchOperationAdd">
                        <success>Always</success>
                        <xpath>Defs[not(DesignationCategoryDef/defName="NQoL_Medical")]</xpath>
                        <value>
                            <DesignationCategoryDef>
                                <defName>NQoL_Medical</defName> <!-- niilo's qol compat -->
                                <label>Medical</label>
                                <description>Hospitals.</description>
                                <order>350</order>
                                <specialDesignatorClasses>
                                    <li>Designator_Cancel</li>
                                    <li>Designator_Deconstruct</li>
                                    <li>Designator_Uninstall</li>
                                </specialDesignatorClasses>
                            </DesignationCategoryDef>
                        </value>
                    </Operation>

                    <Operation Class="XmlExtensions.PatchOperationAddOrReplace">
                        <success>Always</success>
                        <xmlDoc>Designations</xmlDoc>
                        <xpath>
                            Designations/ThingDef[designationCategory or @ParentName="LampBase"][
                            contains(label, "hospital") or 
                            contains(label, "Hospital") or 
                            contains(@Name, "hospital") or 
                            contains(@Name, "Hospital") or

                            contains(@Name, "medical") or 
                            contains(@Name, "Medical") or
                            contains(label, "medical") or 
                            contains(label, "Medical") or 

                            contains(label, "surgical") or 
                            contains(label, "Surgical") or 
                            contains(@Name, "surgical") or 
                            contains(@Name, "Surgical")
                            ]
                        </xpath>
                        <value>
                            <designationCategory>NQoL_Medical</designationCategory>
                        </value>
                    </Operation>


                </caseTrue>
            </Operation>


            <!-- spots -->
            <Operation Class="XmlExtensions.OptionalPatch">
                <modId>carnap2.TPatches</modId>
                <key>DocWorld_DesignationCategoriesSpots</key>
                <defaultValue>false</defaultValue>
                <caseTrue>

                    <Operation Class="PatchOperationAdd">
                        <success>Always</success>
                        <xpath>Defs[not(DesignationCategoryDef/defName="NQoL_Spots")]</xpath>
                        <value>
                            <DesignationCategoryDef>
                                <defName>NQoL_Spots</defName> <!-- compat with niilos qol -->
                                <label>Spots</label>
                                <description>Spots.</description>
                                <order>50</order>
                                <specialDesignatorClasses>
                                    <li>Designator_Cancel</li>
                                    <li>Designator_Deconstruct</li>
                                </specialDesignatorClasses>
                            </DesignationCategoryDef>
                        </value>
                    </Operation>

                </caseTrue>
            </Operation>


            <!-- royalty/meditation -->
            <Operation Class="XmlExtensions.OptionalPatch">
                <modId>carnap2.TPatches</modId>
                <key>DocWorld_DesignationCategoriesMeditation</key>
                <defaultValue>true</defaultValue>
                <caseTrue>

                    <Operation Class="PatchOperationAdd" MayRequire="ludeon.rimworld.royalty">
                        <xpath>Defs</xpath>
                        <value>
                            <DesignationCategoryDef>
                                <defName>DZ_Meditation</defName>
                                <label>Meditation</label>
                                <description>Objects that help one regain psyfocus.</description>
                                <order>220</order>
                                <specialDesignatorClasses>
                                    <li>Designator_Cancel</li>
                                    <li>Designator_Deconstruct</li>
                                    <li>Designator_Uninstall</li>
                                </specialDesignatorClasses>
                            </DesignationCategoryDef>
                        </value>
                    </Operation>

                    <Operation Class="XmlExtensions.PatchOperationAddOrReplace">
                        <xmlDoc>Designations</xmlDoc>
                        <xpath>Designations/ThingDef[
                            designationCategory or 
                            @ParentName="FurnitureBase" or
                            @ParentName="FurnitureWithQualityBase" or
                            @ParentName="ArtableFurnitureBase" or
                            @ParentName="ArtableFurnitureRegardlessOfQualityBase" or
                            @ParentName="NatureShrineBase"
                            ][
                            comps/li/focusTypes/li="Natural" or
                            comps/li/focusTypes/li="Dignified" or
                            comps/li/focusTypes/li="Morbid"
                            ]
                        </xpath>
                        <value>
                            <designationCategory>DZ_Meditation</designationCategory>
                        </value>
                    </Operation>

                </caseTrue>
            </Operation>

            <!-- ideology -->
            <Operation Class="XmlExtensions.OptionalPatch">
                <modId>carnap2.TPatches</modId>
                <key>DocWorld_DesignationCategoriesIdeology</key>
                <defaultValue>true</defaultValue>
                <caseTrue>

                    <Operation Class="PatchOperationAdd" MayRequire="ludeon.rimworld.ideology">
                        <xpath>Defs</xpath>
                        <value>
                            <DesignationCategoryDef>
                                <defName>DZ_Ideology</defName>
                                <label>Ideology</label>
                                <description>Objects to represent one's ideologion.</description>
                                <order>230</order>
                                <specialDesignatorClasses>
                                    <li>Designator_Cancel</li>
                                    <li>Designator_Deconstruct</li>
                                    <li>Designator_Uninstall</li>
                                </specialDesignatorClasses>
                            </DesignationCategoryDef>
                        </value>
                    </Operation>

                    <Operation Class="XmlExtensions.PatchOperationAddOrReplace">
                        <xmlDoc>Designations</xmlDoc>
                        <xpath>
                            Designations/ThingDef[(
                            designationCategory or 
                            @ParentName="IdeoBuildingBase" or
                            @ParentName="AltarBase" or
                            @ParentName="IdeoBuildingConsumableBase" or
                            @ParentName="IdeoBurnableBase" or
                            @ParentName="IdeoSmokerBase")
                            and 

                            (not(
                            <!-- IDEOLOGY BLACKLIST -->
                            defName="ShipArchotechSpore"
                                
                            ))

                            
                            ][
                            placeWorkers/li="PlaceWorker_RitualFocus" or
                            isAltar="true" or
                            building/buildingTags/li="RitualFocus" or
                            placeWorkers/li="PlaceWorker_RitualFocusNoArrow" or
                            ideoBuildingNamerBase
                            ]

                            |
                            <!-- IDEOLOGY WHITELIST -->
                            Designations/ThingDef[
                            defName="AM_RelicSmashingAltar" or 
                            defName="AM_Megalith" or 
                            defName="VME_Obelisk" or 
                            defName="AM_AnimalDatabase" or 
                            defName="VME_MechanoidEffigy"
                            
                            ]
                        </xpath>
                        <value>
                            <designationCategory>DZ_Ideology</designationCategory>
                        </value>
                    </Operation>

                </caseTrue>
            </Operation>

            <!-- decor -->
            <Operation Class="XmlExtensions.OptionalPatch">
                <modId>carnap2.TPatches</modId>
                <key>DocWorld_DesignationCategoriesDecor</key>
                <defaultValue>true</defaultValue>
                <caseTrue>


                    <Operation Class="PatchOperationAdd">
                        <xpath>Defs</xpath>
                        <value>
                            <DesignationCategoryDef>
                                <defName>DZ_Decor</defName>
                                <label>Decor</label>
                                <description>Beautify your base.</description>
                                <order>460</order>
                                <specialDesignatorClasses>
                                    <li>Designator_Cancel</li>
                                    <li>Designator_Deconstruct</li>
                                    <li>Designator_Uninstall</li>
                                </specialDesignatorClasses>
                            </DesignationCategoryDef>
                        </value>
                    </Operation>

                    <Operation Class="XmlExtensions.PatchOperationAddOrReplace">
                        <success>Always</success>
                        <xmlDoc>Designations</xmlDoc>
                        <xpath>
                            Designations/ThingDef[
                            <!-- DECOR WHITELIST -->
                            designationCategory="PropsandDecor" or
                            defName="LTS_StoneBorderCorner" or 
                            defName="LTS_StoneBorderEdge" or 
                            defName="LTS_LumberBorderCorner" or 
                            defName="LTS_LumberBorderEdge" or 
                            defName="LTS_PathA" or 
                            defName="LTS_PathB" or 
                            defName="LTS_BearRug" or 
                            defName="LTS_RugCarpet" or
                            @Name="LTS_ArchBase" or 
                            @Name="LTS_DoorFrameBase"
                            ]
                        </xpath>
                        <value>
                            <designationCategory>DZ_Decor</designationCategory>
                        </value>
                    </Operation>

                </caseTrue>
            </Operation>

            <!-- Industrial -->
            <Operation Class="XmlExtensions.OptionalPatch">
                <modId>carnap2.TPatches</modId>
                <key>DocWorld_DesignationCategoriesDecor</key>
                <defaultValue>true</defaultValue>
                <caseTrue>

                    <Operation Class="PatchOperationAdd">
                        <xpath>Defs</xpath>
                        <value>
                            <DesignationCategoryDef>
                                <defName>DZ_Industrial</defName>
                                <label>Industrial</label>
                                <description>For all your industrial production.</description>
                                <order>570</order>
                                <specialDesignatorClasses>
                                    <li>Designator_Cancel</li>
                                    <li>Designator_Deconstruct</li>
                                    <li>Designator_Uninstall</li>
                                </specialDesignatorClasses>
                            </DesignationCategoryDef>
                        </value>
                    </Operation>

                </caseTrue>
            </Operation>


            <Operation Class="XmlExtensions.MergeDocument">
                <docName>Designations</docName>
            </Operation>

            <Operation Class="XmlExtensions.OptionalPatch">
                <modId>carnap2.TPatches</modId>
                <key>TPatchesLogging</key>
                <defaultValue>false</defaultValue>
                <caseTrue>
                    <Operation Class="XmlExtensions.StopwatchStop" />
                </caseTrue>
            </Operation>

        </caseTrue>
        <caseFalse />
    </Operation>

</Patch>