<?xml version="1.0" encoding="utf-8"?>
<Patch>

    <!--
    <Operation Class="XmlExtensions.OptionalPatch">
    <modId>carnap2.TPatches</modId>
    <key>TPatches???</key>
    <defaultValue>???</defaultValue>
    <caseTrue>
    <Operation Class="???">

    </Operation>
    </caseTrue>
    <caseFalse>

    </caseFalse>
    </Operation>

    -->

    <!-- an always on key -->
    <Operation Class="XmlExtensions.OptionalPatch">
        <modId>carnap2.TPatches</modId>
        <key>TPatchesAlwaysOn</key>
        <defaultValue>true</defaultValue>
        <caseTrue>
            <!-- nothing -->
        </caseTrue>
        <caseFalse>
            <!-- nothing -->
        </caseFalse>
    </Operation>

    <Operation Class="XmlExtensions.OptionalPatch">
        <modId>carnap2.TPatches</modId>
        <key>TPatchesLogging</key>
        <defaultValue>false</defaultValue>
        <caseTrue>
            <!-- nothing -->
        </caseTrue>
        <caseFalse>
            <!-- nothing -->
        </caseFalse>
    </Operation>
    <!--
    <Operation Class="XmlExtensions.OptionalPatch">
        <modId>carnap2.TPatches</modId>
        <key>TPatchesLogging</key>
        <defaultValue>false</defaultValue>
        <caseTrue>
        -->


    <!-- fix factions not showing in create world menu -->
    <Operation Class="XmlExtensions.OptionalPatch">
        <modId>carnap2.TPatches</modId>
        <key>TPatchesFixSomeModdedFactionsNotShowingUpInCreateWorldMenu</key>
        <defaultValue>true</defaultValue>
        <caseTrue>
            <Operation Class="PatchOperationAdd">
                <success>Always</success>
                <xpath>Defs/FactionDef[(defName and not(maxConfigurableAtWorldCreation) and not(hidden="true") and not(isPlayer="true") and(@ParentName="FactionBase" or not(@ParentName))) or (defName="SavageGiants") and not(maxConfigurableAtWorldCreation)]</xpath>
                <value>
                    <maxConfigurableAtWorldCreation>9999</maxConfigurableAtWorldCreation>
                </value>
            </Operation>
        </caseTrue>
        <caseFalse>
            <!--Patch operations here - not needed-->
        </caseFalse>
    </Operation>


    <!-- HAR research restriction removers -->
    <Operation Class="XmlExtensions.OptionalPatch">
        <modId>carnap2.TPatches</modId>
        <key>TPatchesHARResearchRestrictionRemover</key>
        <defaultValue>false</defaultValue>
        <caseTrue>
            <Operation Class="PatchOperationRemove">
                <success>Always</success>
                <xpath>Defs/AlienRace.ThingDef_AlienRace/alienRace/raceRestriction/researchList</xpath>
            </Operation>
        </caseTrue>
        <caseFalse>
            <!--Patch operations here-->
        </caseFalse>
    </Operation>

    <!-- HAR thoughtsettings removers -->
    <!--
    <Operation Class="XmlExtensions.OptionalPatch">
        <modId>carnap2.TPatches</modId>
        <key>TPatchesHARthoughtSettingsRemover</key>
        <defaultValue>false</defaultValue>
        <caseTrue>
            <Operation Class="PatchOperationRemove">
                <success>Always</success>
                <xpath>Defs/AlienRace.ThingDef_AlienRace/alienRace/thoughtSettings</xpath>
            </Operation>
        </caseTrue>
        <caseFalse>
        </caseFalse>
    </Operation>
-->

    <Operation Class="XmlExtensions.OptionalPatch">
        <modId>carnap2.TPatches</modId>
        <key>TPatchesNerubiansFix</key>
        <defaultValue>true</defaultValue>
        <caseTrue>
            <Operation Class="PatchOperationRemove">
                <success>Always</success>
                <xpath>Defs/AlienRace.ThingDef_AlienRace[defName="Nerubian"]/alienRace/raceRestriction/weaponList</xpath>
            </Operation>
        </caseTrue>
        <caseFalse></caseFalse>
    </Operation>

    <!-- VAE Accessories - Ranged Shield Belt nerf -->
    <Operation Class="XmlExtensions.OptionalPatch">
        <modId>carnap2.TPatches</modId>
        <key>TPatchesVAEARangedShieldBelt</key>
        <defaultValue>false</defaultValue>
        <caseTrue>
            <Operation Class="PatchOperationReplace">
                <success>Always</success>
                <xpath>Defs/ThingDef[defName="VAEA_Apparel_RangedShieldBelt"]/statBases/EnergyShieldRechargeRate</xpath>
                <value>
                    <EnergyShieldRechargeRate>0.05</EnergyShieldRechargeRate> <!-- default 0.13 -->
                </value>
            </Operation>
            <Operation Class="PatchOperationReplace">
                <success>Always</success>
                <xpath>Defs/ThingDef[defName="VAEA_Apparel_RangedShieldBelt"]/statBases/EnergyShieldEnergyMax</xpath>
                <value>
                    <EnergyShieldEnergyMax>0.3</EnergyShieldEnergyMax> <!-- default 0.9 -->
                </value>
            </Operation>
        </caseTrue>
        <caseFalse></caseFalse>
    </Operation>

    <!-- VAE Accessories - Mini-turret pack nerf -->
    <Operation Class="XmlExtensions.OptionalPatch">
        <modId>carnap2.TPatches</modId>
        <key>TPatchesVAEAMiniTurretPack</key>
        <defaultValue>false</defaultValue>
        <caseTrue>
            <Operation Class="PatchOperationAdd">
                <success>Always</success>
                <xpath>Defs/ThingDef[defName="VAEA_Apparel_MiniTurretPack"]/recipeMaker[not (researchPrerequisite="GunTurrets")]</xpath>
                <value>
                    <researchPrerequisite>GunTurrets</researchPrerequisite>
                </value>
            </Operation>
            <Operation Class="PatchOperationReplace">
                <success>Always</success>
                <xpath>Defs/ThingDef[defName="VAEA_Apparel_MiniTurretPack"]/verbs/li/defaultProjectile</xpath>
                <value>
                    <defaultProjectile>TPatches_Bullet_MiniTurretPack</defaultProjectile>
                </value>
            </Operation>
            <Operation Class="PatchOperationReplace">
                <success>Always</success>
                <xpath>Defs/ThingDef[defName="VAEA_Apparel_MiniTurretPack"]/verbs/li/range</xpath>
                <value>
                    <range>22.9</range> <!-- default 28.9 -->
                </value>
            </Operation>
        </caseTrue>
        <caseFalse></caseFalse>
    </Operation>

    <Operation Class="XmlExtensions.OptionalPatch">
        <modId>carnap2.TPatches</modId>
        <key>TPatchesLogging</key>
        <defaultValue>false</defaultValue>
        <caseTrue>
            <Operation Class="XmlExtensions.Log">
                <text>Stopwatch: rottable filter</text>
            </Operation>
            <Operation Class="XmlExtensions.StopwatchStart" />
        </caseTrue>
    </Operation>

    <!-- Rottable filter -->
    <Operation Class="XmlExtensions.OptionalPatch">
        <modId>carnap2.TPatches</modId>
        <key>TPatchesFilterRottable</key>
        <defaultValue>true</defaultValue>
        <caseTrue>
            <Operation Class="PatchOperationAdd">
                <xpath>/Defs</xpath>
                <value>
                    <ThingCategoryDef>
                        <defName>TPatchesRottable</defName>
                        <label>*Rottable</label>
                        <parent>Root</parent>
                    </ThingCategoryDef>
                </value>
            </Operation>
            <!-- patch by imranfish -->
            <Operation Class="XmlExtensions.DefDatabaseForEach">
                <objPath>ThingDef/[thingCategories/[defName="MeatRaw"]]</objPath>
                <storeIn>path</storeIn>
                <apply>
                    <!--Add the category to the ThingDef-->
                    <Operation Class="XmlExtensions.DefDatabaseOperationAdd">
                        <objPath>{path}/thingCategories</objPath>
                        <objPath2>ThingCategoryDef/[defName="TPatchesRottable"]</objPath2>
                    </Operation>
                    <!--Add the ThingDef to the ThingCategory-->
                    <Operation Class="XmlExtensions.DefDatabaseOperationAdd">
                        <objPath>ThingCategoryDef/[defName="TPatchesRottable"]/childThingDefs</objPath>
                        <objPath2>{path}</objPath2>
                    </Operation>
                    <!--Add the ThingDef to the ThingCategory's HashSet-->
                    <Operation Class="XmlExtensions.DefDatabaseOperationAdd">
                        <objPath>ThingCategoryDef/[defName="TPatchesRottable"]/allChildThingDefsCached</objPath>
                        <objPath2>{path}</objPath2>
                    </Operation>
                    <!--Add the ThingDef to the ThingCategory's cachedList-->
                    <Operation Class="XmlExtensions.DefDatabaseOperationAdd">
                        <objPath>ThingCategoryDef/[defName="TPatchesRottable"]/sortedChildThingDefsCached</objPath>
                        <objPath2>{path}</objPath2>
                    </Operation>
                </apply>
            </Operation>
            <!--Sort the cached list in the ThingCategory-->
            <Operation Class="XmlExtensions.DefDatabaseOperationSortList">
                <nonNumeric>true</nonNumeric>
                <objPath>ThingCategoryDef/[defName="TPatchesRottable"]/sortedChildThingDefsCached</objPath>
                <objPathLocal>label</objPathLocal>
            </Operation>

            <!-- my xml stuff -->
            <Operation Class="PatchOperationAdd">
                <success>Always</success>
                <xpath>Defs/ThingDef[comps/li[@Class="CompProperties_Rottable"] and (not(@ParentName="MealCookedIngredientless" or @ParentName="MealCooked" or @ParentName="MealFineBase" or @ParentName="MealLavishBase"))]/thingCategories[not(li="TPatchesRottable")]</xpath>
                <value>
                    <li>TPatchesRottable</li>
                </value>
            </Operation>
            <Operation Class="PatchOperationAdd">
                <success>Always</success>
                <xpath>Defs/ThingDef[comps/li[@Class="CompProperties_Rottable"] and (not(@ParentName="MealCookedIngredientless" or @ParentName="MealCooked" or @ParentName="MealFineBase" or @ParentName="MealLavishBase")) and (not(thingCategories))]</xpath>
                <value>
                    <thingCategories>
                        <li>TPatchesRottable</li>
                    </thingCategories>
                </value>
            </Operation>

            <!-- VGE -->
            <Operation Class="PatchOperationAdd">
                <success>Always</success>
                <xpath>Defs/ThingDef[@Name="GR_GeneticsBase" or @Name="GR_GeneticsBaseTier2or3"]/thingCategories[not(li="TPatchesRottable")]</xpath>
                <value>
                    <li>TPatchesRottable</li>
                </value>
            </Operation>

            <!-- Config error in VFEM_SmokedFish: has duplicate thingCategory TPatchesRottable. ?????? -->

        </caseTrue>
        <caseFalse></caseFalse>
    </Operation>

    <Operation Class="XmlExtensions.OptionalPatch">
        <modId>carnap2.TPatches</modId>
        <key>TPatchesLogging</key>
        <defaultValue>false</defaultValue>
        <caseTrue>
            <Operation Class="XmlExtensions.StopwatchStop" />
        </caseTrue>
    </Operation>

    <!-- dubs mint storage research -->
    <Operation Class="XmlExtensions.OptionalPatch">
        <modId>carnap2.TPatches</modId>
        <key>TPatches_DubsMintStorageResearch</key>
        <defaultValue>false</defaultValue>
        <caseTrue>
            <Operation Class="PatchOperationSequence">
                <success>Always</success>
                <operations>
                    <li Class="PatchOperationAdd">
                        <xpath>Defs/ThingDef[(defName="MintDeepStorage") and (not(researchPrerequisites)) and (not(researchPrerequisite))]</xpath>
                        <value>
                            <researchPrerequisites>
                                <li>carnap2_DubsMintStorageResearch</li>
                            </researchPrerequisites>
                        </value>
                    </li>
                    <li Class="PatchOperationAdd">
                        <xpath>Defs</xpath>
                        <value>
                            <ResearchProjectDef>
                                <defName>carnap2_DubsMintStorageResearch</defName>
                                <label>Deep storage</label>
                                <description>Build a long term deep storage system.</description>
                                <baseCost>3600</baseCost>
                                <tab>Main</tab>
                                <techLevel>Industrial</techLevel>
                                <researchViewX>3.00</researchViewX>
                                <researchViewY>3.55</researchViewY>
                                <prerequisites>
                                    <li>MicroelectronicsBasics</li>
                                </prerequisites>
                            </ResearchProjectDef>
                        </value>
                    </li>
                </operations>
            </Operation>

        </caseTrue>
        <caseFalse></caseFalse>
    </Operation>

    <!-- great memory tweak -->
    <Operation Class="XmlExtensions.OptionalPatch">
        <modId>carnap2.TPatches</modId>
        <key>TPatches_GreatMemoryTweak</key>
        <defaultValue>false</defaultValue>
        <caseTrue>
            <Operation Class="PatchOperationAdd">
                <success>Normal</success>
                <xpath>Defs/TraitDef[defName="GreatMemory"]/degreeDatas/li[not(statOffsets/GlobalLearningFactor)]</xpath>
                <value>
                    <statOffsets>
                        <GlobalLearningFactor>0.5</GlobalLearningFactor>
                    </statOffsets>
                </value>
            </Operation>
        </caseTrue>
        <caseFalse></caseFalse>
    </Operation>

    <!-- Infinite Turret Barrels -->
    <Operation Class="XmlExtensions.OptionalPatch">
        <modId>carnap2.TPatches</modId>
        <key>TPatches_InfiniteTurrets</key>
        <defaultValue>false</defaultValue>
        <caseTrue>
            <Operation Class="PatchOperationReplace">
                <success>Always</success>
                <xpath>Defs/ThingDef[statBases/ShootingAccuracyTurret]/comps/li/fuelCapacity</xpath>
                <value>
                    <fuelCapacity>10000</fuelCapacity>
                </value>
            </Operation>
            <Operation Class="PatchOperationReplace">
                <success>Always</success>
                <xpath>Defs/ThingDef[statBases/ShootingAccuracyTurret]/comps/li/fuelMultiplier</xpath>
                <value>
                    <fuelMultiplier>10000</fuelMultiplier>
                </value>
            </Operation>
        </caseTrue>
        <caseFalse></caseFalse>
    </Operation>

    <!-- Enable Oversized Weapons -->
    <!--
    <Operation Class="XmlExtensions.OptionalPatch">
        <modId>carnap2.TPatches</modId>
        <key>TPatches_CompOversizedReplace</key>
        <defaultValue>false</defaultValue>
        <caseTrue>
            <Operation Class="PatchOperationFindMod">
                <mods>
                    <li>Enable Oversized Weapons</li>
                </mods>
                <match Class="PatchOperationRemove">
                    <success>Always</success>
                    <xpath>Defs/ThingDef/comps/li[@Class="CompOversizedWeapon.CompOversizedWeapon" or compClass="CompOversizedWeapon.CompOversizedWeapon" or @Class="CompOversizedWeapon.CompProperties_OversizedWeapon"][not(verticalFlipNorth) and not(angleAdjustmentWest) and not(angleAdjustmentEast) and not(angleAdjustmentSouth) and not(angleAdjustmentEast) and not(northOffset) and not(eastOffset) and not(westOffset) and not(southOffset) and not(isDualWeapon) and not(verticalFlipOutsideCombat)]</xpath>
                </match>
            </Operation>
        </caseTrue>
        <caseFalse></caseFalse>
    </Operation>
-->


    <!-- can auto choose -->

    <Operation Class="XmlExtensions.OptionalPatch">
        <modId>carnap2.TPatches</modId>
        <key>TPatches_BiomesCanAutoChoose</key>
        <defaultValue>false</defaultValue>
        <caseTrue>

            <Operation Class="PatchOperationRemove">
                <xpath>Defs/BiomeDef/canAutoChoose</xpath>
            </Operation>

        </caseTrue>
        <caseFalse></caseFalse>
    </Operation>


    <Operation Class="XmlExtensions.OptionalPatch">
        <modId>carnap2.TPatches</modId>
        <key>TPatches_BuildableIdeos</key>
        <defaultValue>false</defaultValue>
        <caseTrue>

            <Operation Class="PatchOperationRemove">
                <success>Always</success>
                <xpath>Defs/TerrainDef/canGenerateDefaultDesignator</xpath>
            </Operation>
            <Operation Class="PatchOperationRemove">
                <success>Always</success>
                <xpath>Defs/ThingDef[
                            @Name="IdeoBuildingBase" or 
                            @Name="RitualSeatBase" or 
                            @Name="BuildingFloorCoveringBase" or 
                            defName="AM_AnimalDatabase" or 
                            defName="AM_TrapBlunt" or 
                            defName="AM_RelicSmashingAltar" or 
                            defName="AM_Pyramid" or 
                            defName="VME_BonfireAfterRitual" or 
                            defName="VME_MechanoidEffigy" or 
                            defName="VME_Obelisk" or 
                            defName="SleepAccelerator" or 
                            defName="BiosculpterPod" or 
                            defName="NeuralSupercharger" or 
                            defName="Autobong" or 
                            defName="VME_InsectNest" or 
                            defName="AM_GrogDispenser" or 
                            defName="AM_Megalith" or 
                            defName="AM_StoneBedroll" or
                            @Name="AM_NoDesignatorTableBaseStone" or
                            @Name="AM_NoDesignatorTableBaseWood" or 
                            @ParentName="SculptureBase"
                            ]/canGenerateDefaultDesignator</xpath>
            </Operation>
            <Operation Class="PatchOperationRemove">
                <success>Always</success>
                <xpath>Defs/ThingDef/recipeMaker/memePrerequisitesAny</xpath>
            </Operation>

        </caseTrue>
        <caseFalse></caseFalse>
    </Operation>

    <Operation Class="XmlExtensions.OptionalPatch">
        <modId>carnap2.TPatches</modId>
        <key>TPatchesLogging</key>
        <defaultValue>false</defaultValue>
        <caseTrue>
            <Operation Class="XmlExtensions.Log">
                <text>Stopwatch: styles to variations</text>
            </Operation>
            <Operation Class="XmlExtensions.StopwatchStart" />
        </caseTrue>
    </Operation>

    <Operation Class="XmlExtensions.OptionalPatch">
        <modId>carnap2.TPatches</modId>
        <key>TPatchesLogging_IdeoVTE</key>
        <defaultValue>false</defaultValue>
        <caseTrue>
            <Operation Class="XmlExtensions.OptionalPatch">
                <modId>carnap2.TPatches</modId>
                <key>TPatches_IdeoStylesToVTEVariations</key>
                <defaultValue>false</defaultValue>
                <caseTrue>
                    <Operation Class="XmlExtensions.PatchOperationAdd">
                        <xmlDoc>Log</xmlDoc>
                        <xpath>Log/settings</xpath>
                        <value>
                            <li Class="XmlExtensions.Setting.GapLine" />
                            <li Class="XmlExtensions.Setting.SetColor">
                                <color>(255,128,128)</color>
                            </li>
                        </value>
                    </Operation>
                    <Operation Class="XmlExtensions.ForEach">
                        <!--<success>Always</success>-->
                        <xpath>Defs/StyleCategoryDef/thingDefStyles/li[

                            
                            contains(thingDef, "Apparel") or 
                            contains(thingDef, "Gun") or 
                            contains(thingDef, "Weapon") or 
                            contains(thingDef, "Melee") or 
                            contains(thingDef, "Bow") or 
                            contains(thingDef, "Pipe") or 
                            thingDef="Pila" or 
                            thingDef="PowerConduit" or 
                            thingDef="WaterproofConduit" or 
                            thingDef="Sandbags" or 
                            thingDef="Barricade" or 
                            thingDef="HighVoltage" or 
                            thingDef="controllerLoom" or 
                            thingDef="GNGlitterNetCable" or 
                            thingDef="Wall" or 
                            thingDef="Fence" or 
                            thingDef="VFEArch_LogWall" or 
                            thingDef="VFEArch_ChainlinkFence" or 
                            thingDef="VFEArch_PicketFence" or 
                            thingDef="VFEArch_BrickFence" or 
                            thingDef="VFEArch_LowFence" or 
                            thingDef="VFEArch_HedgeWall" or 
                            thingDef="VFEArch_CellWall" or 
                            thingDef="ComponentIndustrial" or 
                            thingDef="MealNutrientPaste" or 
                            thingDef="IM_Cyrogatana" or 
                            thingDef="VWE_Sling" or 
                            thingDef="VWE_ThrowingShards" or 
                            thingDef="Owl_Heater"
                            

                            ]/thingDef</xpath>
                        <storeIn>stylelog</storeIn>
                        <prefixLength>4</prefixLength>
                        <apply>
                            <Operation Class="XmlExtensions.CreateVariable">
                                <storeIn>thingDeflog</storeIn>
                                <value>{stylelog}/thingDef</value>
                                <fromXml>true</fromXml>
                                <defaultValue>idkthinglog</defaultValue>
                                <apply>
                                    <Operation Class="XmlExtensions.Conditional">
                                        <xpath>Defs/ThingDef[defName = "{thingDeflog}"]/graphicData[graphicClass="Graphic_Single"]</xpath>
                                        <caseTrue>

                                            <Operation Class="XmlExtensions.CreateVariable">
                                                <storeIn>thingtexlog</storeIn>
                                                <value>Defs/ThingDef[defName = "{thingDeflog}"]/graphicData/texPath</value>
                                                <fromXml>true</fromXml>
                                                <defaultValue>World/WorldObjects/Expanding/PeaceTalks</defaultValue>
                                                <apply>


                                                    <Operation Class="XmlExtensions.PatchOperationAdd">
                                                        <success>Always</success>
                                                        <xmlDoc>Log</xmlDoc>
                                                        <xpath>Log/settings[not(li/tag="{thingDeflog}")]</xpath>
                                                        <value>
                                                            <li Class="XmlExtensions.Setting.SplitColumns">
                                                                <tag>{thingDeflog}</tag>
                                                                <gapSize>6</gapSize>
                                                                <splits>
                                                                    <li>0.05</li>
                                                                </splits>
                                                                <settings>
                                                                    <li>
                                                                        <li Class="XmlExtensions.Setting.DrawImage">
                                                                            <texPath>{thingtexlog}</texPath>
                                                                            <anchor>Left</anchor>
                                                                        </li>
                                                                    </li>
                                                                    <li>
                                                                        <li Class="XmlExtensions.Setting.Text">
                                                                            <text>{thingDeflog}</text>
                                                                        </li>
                                                                    </li>
                                                                </settings>
                                                            </li>


                                                        </value>
                                                    </Operation>
                                                </apply>
                                            </Operation>
                                        </caseTrue>
                                        <caseFalse>
                                            <Operation Class="XmlExtensions.PatchOperationAdd">
                                                <success>Always</success>
                                                <xmlDoc>Log</xmlDoc>
                                                <xpath>Log/settings[not(li/tag="{thingDeflog}")]</xpath>
                                                <value>
                                                    <li Class="XmlExtensions.Setting.SplitColumns">
                                                        <tag>{thingDeflog}</tag>
                                                        <gapSize>6</gapSize>
                                                        <splits>
                                                            <li>0.05</li>
                                                        </splits>
                                                        <settings>
                                                            <li>
                                                                <li Class="XmlExtensions.Setting.Text">
                                                                    <font>Medium</font>
                                                                    <text>NO</text>
                                                                </li>
                                                            </li>
                                                            <li>
                                                                <li Class="XmlExtensions.Setting.Text">
                                                                    <text>{thingDeflog}</text>
                                                                </li>
                                                            </li>
                                                        </settings>
                                                    </li>
                                                </value>
                                            </Operation>
                                        </caseFalse>
                                    </Operation>
                                </apply>
                            </Operation>
                        </apply>
                    </Operation>
                    <Operation Class="XmlExtensions.PatchOperationAdd">
                        <xmlDoc>Log</xmlDoc>
                        <xpath>Log/settings</xpath>
                        <value>
                            <li Class="XmlExtensions.Setting.SetColor">
                                <color>(255,255,255)</color>
                            </li>
                            <li Class="XmlExtensions.Setting.GapLine" />
                        </value>
                    </Operation>

                    <Operation Class="PatchOperationFindMod">
                        <mods>
                            <li>Vanilla Textures Expanded - Variations</li>
                        </mods>

                        <!-- 
                        thingDef="VPE_GasPipe" or
                        thingDef="VCHE_DeepchemPipe" or 
                        thingDef="VCHE_ChemfuelPipe" or
                        thingDef="sewagePipeStuff" or
                        thingDef="airPipe" or 
                        thingDef="coolingPipe" or 
                        thingDef="steamPipe" or 
                        thingDef="waterPipe" or 
                        


                -->

                        <match Class="XmlExtensions.ForEach">
                            <xpath>Defs/StyleCategoryDef/thingDefStyles/li[not(


                                contains(thingDef, "Apparel") or 
                                contains(thingDef, "Gun") or 
                                contains(thingDef, "Weapon") or 
                                contains(thingDef, "Melee") or 
                                contains(thingDef, "Bow") or 
                                contains(thingDef, "Pipe") or 
                                thingDef="Pila" or 
                                thingDef="PowerConduit" or 
                                thingDef="WaterproofConduit" or 
                                thingDef="Sandbags" or 
                                thingDef="Barricade" or 
                                thingDef="HighVoltage" or 
                                thingDef="controllerLoom" or 
                                thingDef="GNGlitterNetCable" or 
                                thingDef="Wall" or 
                                thingDef="Fence" or 
                                thingDef="VFEArch_LogWall" or 
                                thingDef="VFEArch_ChainlinkFence" or 
                                thingDef="VFEArch_PicketFence" or 
                                thingDef="VFEArch_BrickFence" or 
                                thingDef="VFEArch_LowFence" or 
                                thingDef="VFEArch_HedgeWall" or 
                                thingDef="VFEArch_CellWall" or 
                                thingDef="ComponentIndustrial" or 
                                thingDef="MealNutrientPaste" or 
                                thingDef="IM_Cyrogatana" or 
                                thingDef="VWE_Sling" or 
                                thingDef="VWE_ThrowingShards" or 
                                thingDef="Owl_Heater"


                        )]</xpath>
                            <storeIn>style</storeIn>
                            <prefixLength>4</prefixLength>
                            <apply>
                                <Operation Class="XmlExtensions.AggregateValues">
                                    <valueOperations>
                                        <Operation Class="XmlExtensions.CreateVariable">
                                            <storeIn>thingDef</storeIn>
                                            <value>{style}/thingDef</value>
                                            <fromXml>true</fromXml>
                                            <defaultValue>idkthing</defaultValue>
                                        </Operation>
                                        <Operation Class="XmlExtensions.CreateVariable">
                                            <storeIn>styleDef</storeIn>
                                            <value>{style}/styleDef</value>
                                            <fromXml>true</fromXml>
                                            <defaultValue>idkstyle</defaultValue>
                                        </Operation>
                                    </valueOperations>
                                    <apply>
                                        <Operation Class="XmlExtensions.CreateVariable">
                                            <storeIn>texture</storeIn>
                                            <value>Defs/ThingStyleDef[defName="{styleDef}"]/graphicData/texPath</value>
                                            <fromXml>true</fromXml>
                                            <defaultValue>World/WorldObjects/Expanding/PeaceTalks</defaultValue>
                                            <apply>
                                                <Operation Class="PatchOperationSequence">
                                                    <success>Always</success>
                                                    <operations>
                                                        <li Class="XmlExtensions.Conditional">
                                                            <xpath>Defs/ThingDef[defName = "{thingDef}"]/graphicData[graphicClass="Graphic_Single"]</xpath>
                                                            <caseTrue>

                                                                <Operation Class="XmlExtensions.CreateVariable">
                                                                    <storeIn>thingtexlog</storeIn>
                                                                    <value>Defs/ThingDef[defName = "{thingDef}"]/graphicData/texPath</value>
                                                                    <fromXml>true</fromXml>
                                                                    <defaultValue>World/WorldObjects/Expanding/PeaceTalks</defaultValue>
                                                                    <apply>


                                                                        <Operation Class="XmlExtensions.PatchOperationAdd">
                                                                            <success>Always</success>
                                                                            <xmlDoc>Log</xmlDoc>
                                                                            <xpath>Log/settings[not(li/tag="{thingDef}")]</xpath>
                                                                            <value>
                                                                                <li Class="XmlExtensions.Setting.SplitColumns">
                                                                                    <tag>{thingDef}</tag>
                                                                                    <gapSize>6</gapSize>
                                                                                    <splits>
                                                                                        <li>0.05</li>
                                                                                    </splits>
                                                                                    <settings>
                                                                                        <li>
                                                                                            <li Class="XmlExtensions.Setting.DrawImage">
                                                                                                <texPath>{thingtexlog}</texPath>
                                                                                                <anchor>Left</anchor>
                                                                                            </li>
                                                                                        </li>
                                                                                        <li>
                                                                                            <li Class="XmlExtensions.Setting.Text">
                                                                                                <text>{thingDef}</text>
                                                                                            </li>
                                                                                        </li>
                                                                                    </settings>
                                                                                </li>


                                                                            </value>
                                                                        </Operation>
                                                                    </apply>
                                                                </Operation>
                                                            </caseTrue>
                                                            <caseFalse>
                                                                <Operation Class="XmlExtensions.PatchOperationAdd">
                                                                    <success>Always</success>
                                                                    <xmlDoc>Log</xmlDoc>
                                                                    <xpath>Log/settings[not(li/tag="{thingDef}")]</xpath>
                                                                    <value>

                                                                        <li Class="XmlExtensions.Setting.SplitColumns">
                                                                            <tag>{thingDef}</tag>
                                                                            <gapSize>6</gapSize>
                                                                            <splits>
                                                                                <li>0.05</li>
                                                                            </splits>
                                                                            <settings>
                                                                                <li>
                                                                                    <li Class="XmlExtensions.Setting.Text">
                                                                                        <font>Medium</font>
                                                                                        <text>NO</text>
                                                                                    </li>
                                                                                </li>
                                                                                <li>
                                                                                    <li Class="XmlExtensions.Setting.Text">
                                                                                        <text>{thingDef}</text>
                                                                                    </li>
                                                                                </li>
                                                                            </settings>
                                                                        </li>

                                                                    </value>
                                                                </Operation>
                                                            </caseFalse>
                                                        </li>

                                                        <li Class="XmlExtensions.Log">
                                                            <text>thingDef: {thingDef}; styleDef: {styleDef}; texture: {texture}</text>
                                                        </li>

                                                        <li Class="PatchOperationAdd">
                                                            <success>Invert</success>
                                                            <xpath>Defs/ThingDef[defName = "{thingDef}"]/comps/li[@Class="VanillaFurnitureExpanded.CompProperties_RandomBuildingGraphic"]/randomGraphics</xpath>
                                                            <value>
                                                                <li>{texture}</li>
                                                            </value>
                                                        </li>


                                                        <li Class="XmlExtensions.CreateVariable">
                                                            <storeIn>thingtex</storeIn>
                                                            <value>Defs/ThingDef[defName = "{thingDef}"]/graphicData/texPath</value>
                                                            <fromXml>true</fromXml>
                                                            <defaultValue>World/WorldObjects/Expanding/PeaceTalks</defaultValue>
                                                            <apply>

                                                                <Operation Class="XmlExtensions.Log">
                                                                    <text>---thing texture: {thingtex}</text>
                                                                </Operation>

                                                                <Operation Class="PatchOperationAdd">
                                                                    <success>Invert</success>
                                                                    <xpath>Defs/ThingDef[defName = "{thingDef}"]/comps</xpath>
                                                                    <value>
                                                                        <li Class="VanillaFurnitureExpanded.CompProperties_RandomBuildingGraphic">
                                                                            <randomGraphics>
                                                                                <li>{thingtex}</li>
                                                                                <li>{texture}</li>
                                                                            </randomGraphics>
                                                                        </li>
                                                                    </value>
                                                                </Operation>

                                                                <!--
                                                                <Operation Class="XmlExtensions.Log">
                                                                    <text>no comps</text>
                                                                </Operation>
                                                            -->

                                                                <Operation Class="PatchOperationAdd">
                                                                    <xpath>Defs/ThingDef[defName = "{thingDef}"]</xpath>
                                                                    <value>
                                                                        <comps>
                                                                            <li Class="VanillaFurnitureExpanded.CompProperties_RandomBuildingGraphic">
                                                                                <randomGraphics>
                                                                                    <li>{thingtex}</li>
                                                                                    <li>{texture}</li>
                                                                                </randomGraphics>
                                                                            </li>
                                                                        </comps>
                                                                    </value>
                                                                </Operation>

                                                            </apply>
                                                        </li>


                                                    </operations>
                                                </Operation>
                                                <!--
                                                <Operation Class="XmlExtensions.Log">
                                                    <text>______________</text>
                                                </Operation>
                                            -->


                                            </apply>
                                        </Operation>


                                    </apply>
                                </Operation>
                            </apply>
                        </match>
                    </Operation>

                    <Operation Class="PatchOperationRemove">
                        <success>Always</success>
                        <xpath>Defs/ThingDef/comps/li[@Class="VanillaFurnitureExpanded.CompProperties_RandomBuildingGraphic"]/randomGraphics/li[text()="World/WorldObjects/Expanding/PeaceTalks"]</xpath>
                    </Operation>

                    <Operation Class="PatchOperationRemove">
                        <success>Always</success>
                        <xpath>Defs/ThingDef/comps/li[@Class="VanillaFurnitureExpanded.CompProperties_RandomBuildingGraphic"]/randomGraphics/li[text()="Things/Building/Misc/Ideogram/IconChristian/IconChristianA"][2]</xpath>
                    </Operation>

                    <Operation Class="XmlExtensions.PatchOperationAdd">
                        <xmlDoc>Log</xmlDoc>
                        <xpath>Log/settings</xpath>
                        <value>
                            <li Class="XmlExtensions.Setting.GapLine" />
                        </value>
                    </Operation>

                </caseTrue>
                <caseFalse></caseFalse>
            </Operation>

        </caseTrue>
        <caseFalse>
            <Operation Class="XmlExtensions.OptionalPatch">
                <modId>carnap2.TPatches</modId>
                <key>TPatches_IdeoStylesToVTEVariations</key>
                <defaultValue>false</defaultValue>
                <caseTrue>
                    <Operation Class="PatchOperationFindMod">
                        <mods>
                            <li>Vanilla Textures Expanded - Variations</li>
                        </mods>

                        <!-- 
                        thingDef="VPE_GasPipe" or
                        thingDef="VCHE_DeepchemPipe" or 
                        thingDef="VCHE_ChemfuelPipe" or
                        thingDef="sewagePipeStuff" or
                        thingDef="airPipe" or 
                        thingDef="coolingPipe" or 
                        thingDef="steamPipe" or 
                        thingDef="waterPipe" or 
                        


                -->
                        <match Class="XmlExtensions.ForEach">
                            <xpath>Defs/StyleCategoryDef/thingDefStyles/li[not(


                                contains(thingDef, "Apparel") or 
                                contains(thingDef, "Gun") or 
                                contains(thingDef, "Weapon") or 
                                contains(thingDef, "Melee") or 
                                contains(thingDef, "Bow") or 
                                contains(thingDef, "Pipe") or 
                                thingDef="Pila" or 
                                thingDef="PowerConduit" or 
                                thingDef="WaterproofConduit" or 
                                thingDef="Sandbags" or 
                                thingDef="Barricade" or 
                                thingDef="HighVoltage" or 
                                thingDef="controllerLoom" or 
                                thingDef="GNGlitterNetCable" or 
                                thingDef="Wall" or 
                                thingDef="Fence" or 
                                thingDef="VFEArch_LogWall" or 
                                thingDef="VFEArch_ChainlinkFence" or 
                                thingDef="VFEArch_PicketFence" or 
                                thingDef="VFEArch_BrickFence" or 
                                thingDef="VFEArch_LowFence" or 
                                thingDef="VFEArch_HedgeWall" or 
                                thingDef="VFEArch_CellWall" or 
                                thingDef="VFEArch_ArmoredWall" or 
                                thingDef="ComponentIndustrial" or 
                                thingDef="MealNutrientPaste" or 
                                thingDef="IM_Cyrogatana" or 
                                thingDef="VWE_Sling" or 
                                thingDef="VWE_ThrowingShards" or 
                                thingDef="Owl_Heater"


                        )]</xpath>
                            <storeIn>style</storeIn>
                            <prefixLength>4</prefixLength>
                            <apply>
                                <Operation Class="XmlExtensions.AggregateValues">
                                    <valueOperations>
                                        <Operation Class="XmlExtensions.CreateVariable">
                                            <storeIn>thingDef</storeIn>
                                            <value>{style}/thingDef</value>
                                            <fromXml>true</fromXml>
                                            <defaultValue>idkthing</defaultValue>
                                        </Operation>
                                        <Operation Class="XmlExtensions.CreateVariable">
                                            <storeIn>styleDef</storeIn>
                                            <value>{style}/styleDef</value>
                                            <fromXml>true</fromXml>
                                            <defaultValue>idkstyle</defaultValue>
                                        </Operation>
                                    </valueOperations>
                                    <apply>
                                        <Operation Class="XmlExtensions.CreateVariable">
                                            <storeIn>texture</storeIn>
                                            <value>Defs/ThingStyleDef[defName="{styleDef}"]/graphicData/texPath</value>
                                            <fromXml>true</fromXml>
                                            <defaultValue>World/WorldObjects/Expanding/PeaceTalks</defaultValue>
                                            <apply>
                                                <!--
                                        <Operation Class="XmlExtensions.Log">
                                            <text>STYLE: {style};   thingDef: {thingDef};   styleDef: {styleDef}; texture: {texture}</text>
                                        </Operation>

                                        <Operation Class="XmlExtensions.StopwatchStart" />
                                    -->
                                                <Operation Class="PatchOperationSequence">
                                                    <success>Always</success>
                                                    <operations>

                                                        <li Class="PatchOperationAdd">
                                                            <success>Invert</success>
                                                            <xpath>Defs/ThingDef[defName = "{thingDef}"]/comps/li[@Class="VanillaFurnitureExpanded.CompProperties_RandomBuildingGraphic"]/randomGraphics</xpath>
                                                            <value>
                                                                <li>{texture}</li>
                                                            </value>
                                                        </li>

                                                        <li Class="XmlExtensions.CreateVariable">
                                                            <storeIn>thingtex</storeIn>
                                                            <value>Defs/ThingDef[defName = "{thingDef}"]/graphicData/texPath</value>
                                                            <fromXml>true</fromXml>
                                                            <defaultValue>World/WorldObjects/Expanding/PeaceTalks</defaultValue>
                                                            <apply>

                                                                <Operation Class="PatchOperationAdd">
                                                                    <success>Invert</success>
                                                                    <xpath>Defs/ThingDef[defName = "{thingDef}"]/comps</xpath>
                                                                    <value>
                                                                        <li Class="VanillaFurnitureExpanded.CompProperties_RandomBuildingGraphic">
                                                                            <randomGraphics>
                                                                                <li>{thingtex}</li>
                                                                                <li>{texture}</li>
                                                                            </randomGraphics>
                                                                        </li>
                                                                    </value>
                                                                </Operation>

                                                                <Operation Class="PatchOperationAdd">
                                                                    <xpath>Defs/ThingDef[defName = "{thingDef}"]</xpath>
                                                                    <value>
                                                                        <comps>
                                                                            <li Class="VanillaFurnitureExpanded.CompProperties_RandomBuildingGraphic">
                                                                                <randomGraphics>
                                                                                    <li>{thingtex}</li>
                                                                                    <li>{texture}</li>
                                                                                </randomGraphics>
                                                                            </li>
                                                                        </comps>
                                                                    </value>
                                                                </Operation>

                                                            </apply>
                                                        </li>


                                                    </operations>
                                                </Operation>


                                            </apply>
                                        </Operation>


                                    </apply>
                                </Operation>
                            </apply>
                        </match>
                    </Operation>

                    <Operation Class="PatchOperationRemove">
                        <success>Always</success>
                        <xpath>Defs/ThingDef/comps/li[@Class="VanillaFurnitureExpanded.CompProperties_RandomBuildingGraphic"]/randomGraphics/li[text()="World/WorldObjects/Expanding/PeaceTalks"]</xpath>
                    </Operation>

                    <Operation Class="PatchOperationRemove">
                        <success>Always</success>
                        <xpath>Defs/ThingDef/comps/li[@Class="VanillaFurnitureExpanded.CompProperties_RandomBuildingGraphic"]/randomGraphics/li[text()="Things/Building/Misc/Ideogram/IconChristian/IconChristianA"][2]</xpath>
                    </Operation>

                </caseTrue>
                <caseFalse></caseFalse>
            </Operation>
        </caseFalse>
    </Operation>

    <Operation Class="XmlExtensions.OptionalPatch">
        <modId>carnap2.TPatches</modId>
        <key>TPatchesLogging</key>
        <defaultValue>false</defaultValue>
        <caseTrue>
            <Operation Class="XmlExtensions.StopwatchStop" />
        </caseTrue>
    </Operation>


    <!--
    <Operation Class="XmlExtensions.OptionalPatch">
    <modId>carnap2.TPatches</modId>
    <key>TPatches???</key>
    <defaultValue>???</defaultValue>
    <caseTrue>

        ?????

    </caseTrue>
    <caseFalse>

    </caseFalse>
    </Operation>

    -->

</Patch>